import{r as l,j as e,I as g,T as w,d as f,B as S}from"./index-BIcbHDZS.js";import{u as $}from"./useQuery-cla0o0Kh.js";import{T as C,P as E}from"./TextField-uuShNIW1.js";import{I as P,S as R,T as F,a as A,b as B,c as p,d as t,e as D}from"./Search-wxjobjig.js";import{T as y}from"./Typography-Bwb-8M5c.js";import{D as I}from"./Delete-BeDMGDrI.js";const k=async(n,r,c,o,i)=>(await f.get(`${S}/api/campus/students/${n}/${r}?page=${c}&limit=${o}&search=${i}`,{withCredentials:!0})).data,H=({sectionId:n})=>{const[r,c]=l.useState(""),[o,i]=l.useState(r),[a,m]=l.useState(1),d=10,x="";l.useEffect(()=>{const s=setTimeout(()=>{i(r),m(1)},400);return()=>clearTimeout(s)},[r]);const{data:h,isLoading:j,refetch:T}=$({queryKey:["students",n,x,a,o],queryFn:()=>k(n,x,a,d,o),enabled:!!n&&!1});l.useEffect(()=>{console.log("Group ID changed:",x),console.log(h)},[j]);const N=async s=>{try{await f.delete(`${S}/api/campus/students/${n}/${s}`,{withCredentials:!0}),T()}catch(v){console.error("Failed to remove student",v)}},b=h?.data||[],u=h?.total||0;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{value:r,onChange:s=>c(s.target.value),size:"small",label:"Search by name or email",InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(g,{size:"small",edge:"start",children:e.jsx(R,{})})})},sx:{maxWidth:320}}),j?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsx(F,{component:E,className:"shadow mt-10 rounded-lg",children:e.jsxs(A,{children:[e.jsx(B,{className:"bg-orange-50",children:e.jsxs(p,{children:[e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Role"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsxs(D,{children:[b.length===0&&e.jsx(p,{children:e.jsx(t,{colSpan:7,align:"center",children:e.jsx(y,{color:"textSecondary",children:"No students found"})})}),b.map(s=>e.jsxs(p,{hover:!0,className:"transition duration-150 ease-in-out",children:[e.jsx(t,{children:s.name}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.role}),e.jsx(t,{children:s.status==="member"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:"Member"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 rounded",children:"Pending"})}),e.jsx(t,{children:e.jsx(w,{title:"Remove Student",children:e.jsx(g,{size:"small",color:"error",onClick:()=>N(s._id),children:e.jsx(I,{})})})})]},s._id))]})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs(y,{variant:"body2",color:"textSecondary",children:["Showing ",(a-1)*d+1," - ",Math.min(a*d,u)," ","of ",u]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:a===1,onClick:()=>m(s=>s-1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:a*d>=u,onClick:()=>m(s=>s+1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})]})]})};export{H as S};
