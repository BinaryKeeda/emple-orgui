import{r,$ as w,j as e,I as b,x as $,t as f,B as S}from"./index-Dm6XyL4l.js";import{u as C}from"./useQuery-BbZ0NZ13.js";import{T as I}from"./TextField-BFRpBTkm.js";import{I as P,S as E,T as R,a as F,b as A,c as u,d as t,e as B}from"./Search-DxMsmx6_.js";import{P as D}from"./Modal-CBLXFOlt.js";import{T as y}from"./Typography-DlwFXgy0.js";import{D as k}from"./Delete-BIXPWRyc.js";const z=async(n,c,o,d)=>{const a=await f.get(`${S}/api/campus/students/${n}/?page=${c}&limit=${o}&search=${d}`,{withCredentials:!0});return console.log(a.data),a.data},Q=({})=>{const[n,c]=r.useState(""),[o,d]=r.useState(n),[a,i]=r.useState(1),l=10,p="",{id:m}=w();r.useEffect(()=>{const s=setTimeout(()=>{d(n),i(1)},400);return()=>clearTimeout(s)},[n]);const{data:x,isLoading:j,refetch:T}=C({queryKey:["students",m,p,a,o],queryFn:()=>z(m,a,l,o)});r.useEffect(()=>{console.log("Group ID changed:",p),console.log(x)},[j]);const N=async s=>{try{await f.delete(`${S}/api/campus/students/${m}/${s}`,{withCredentials:!0}),T()}catch(v){console.error("Failed to remove student",v)}},g=x?.data||[],h=x?.total||0;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{value:n,onChange:s=>c(s.target.value),size:"small",label:"Search by name or email",InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(b,{size:"small",edge:"start",children:e.jsx(E,{})})})},sx:{maxWidth:320}}),j?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsx(R,{component:D,className:"shadow mt-10 rounded-lg",children:e.jsxs(F,{children:[e.jsx(A,{className:"bg-orange-50",children:e.jsxs(u,{children:[e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Role"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsxs(B,{children:[g.length===0&&e.jsx(u,{children:e.jsx(t,{colSpan:7,align:"center",children:e.jsx(y,{color:"textSecondary",children:"No students found"})})}),g.map(s=>e.jsxs(u,{hover:!0,className:"transition duration-150 ease-in-out",children:[e.jsx(t,{children:s.name}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.role}),e.jsx(t,{children:s.status==="member"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:"Member"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 rounded",children:"Pending"})}),e.jsx(t,{children:e.jsx($,{title:"Remove Student",children:e.jsx(b,{size:"small",color:"error",onClick:()=>N(s._id),children:e.jsx(k,{})})})})]},s._id))]})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs(y,{variant:"body2",color:"textSecondary",children:["Showing ",(a-1)*l+1," - ",Math.min(a*l,h)," ","of ",h]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:a===1,onClick:()=>i(s=>s-1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:a*l>=h,onClick:()=>i(s=>s+1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})]})]})};export{Q as S};
