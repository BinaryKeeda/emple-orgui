const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddTestProblemModal-DYPFBnEB.js","assets/index-BuY4eNlI.js","assets/index-C1ad7qXj.css","assets/Modal-B2FXj-VE.js","assets/Typography-D809mijF.js","assets/TextField-CVtzyiV0.js","assets/MenuItem-DcUE3Mnx.js","assets/dividerClasses-GkafQR8b.js","assets/Button-DJkcb0lZ.js","assets/AddTestSectionQuestionsModal-VTDtLEF0.js","assets/xlsx-DSqvgYLF.js","assets/Checkbox-CjZcWKdd.js"])))=>i.map(i=>d[i]);
import{Y as I,r as l,j as e,C as k,t as g,B as p,a3 as z}from"./index-BuY4eNlI.js";import{A as D}from"./Add-BlBz7IAU.js";import{T as u}from"./Typography-D809mijF.js";import{T as r}from"./TextField-CVtzyiV0.js";import{M as n}from"./MenuItem-DcUE3Mnx.js";import{B as m}from"./Button-DJkcb0lZ.js";import{P as O}from"./Modal-B2FXj-VE.js";import{A as W,a as L,b as V}from"./AccordionSummary-DdhWzD5c.js";import"./dividerClasses-GkafQR8b.js";const B=l.lazy(()=>z(()=>import("./AddTestProblemModal-DYPFBnEB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),R=l.lazy(()=>z(()=>import("./AddTestSectionQuestionsModal-VTDtLEF0.js"),__vite__mapDeps([9,1,2,10,3,4,8,5,6,7,11])));function ee(){const{slug:d}=I(),[a,i]=l.useState(null),[_,j]=l.useState(!0),[y,P]=l.useState(null),[o,h]=l.useState({name:"",sectionType:"Quiz"}),[f,b]=l.useState(!1),[v,C]=l.useState(!1),[Q,N]=l.useState(null),[w,S]=l.useState(null),M=s=>N(s),T=()=>N(null),E=s=>S(s),A=()=>S(null),x=async()=>{try{j(!0);const s=await g.get(`${p}/api/admin/tests/${d}`,{withCredentials:!0});i(s.data.data)}catch(s){console.error(s),P("Failed to fetch test")}finally{j(!1)}};l.useEffect(()=>{d&&x()},[d]);const F=async()=>{try{b(!0);const s=await g.post(`${p}/api/admin/tests/${d}/sections`,o,{withCredentials:!0});i(s.data.data),h({name:"",sectionType:"Quiz"})}catch(s){console.error("Failed to add section",s),alert("Failed to add section")}finally{b(!1)}},$=async()=>{if(a)try{C(!0);const s=await g.put(`${p}/api/admin/tests/update/${d}`,a,{withCredentials:!0});i(s.data.data)}catch(s){console.error("Failed to update test",s),alert("Failed to save changes")}finally{C(!1)}};return _?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(k,{})}):y?e.jsx(u,{color:"error",children:y}):a?e.jsxs("div",{className:"p-6 md:p-10 bg-gray-50 min-h-screen",children:[e.jsxs("h4",{className:"font-bold mb-6 text-gray-800 text-xl",children:["Edit Test - ",a.name]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsx(r,{size:"small",label:"Test Name",value:a.name,onChange:s=>i({...a,name:s.target.value}),fullWidth:!0}),e.jsx(r,{size:"small",label:"Duration (minutes)",type:"number",value:a.duration??"",onChange:s=>i({...a,duration:parseInt(s.target.value,10)||0}),fullWidth:!0}),e.jsx(r,{label:"Description",size:"small",value:a.description??"",onChange:s=>i({...a,description:s.target.value}),fullWidth:!0,multiline:!0,rows:3}),e.jsxs(r,{select:!0,size:"small",label:"Category",value:a.category,onChange:s=>i({...a,category:s.target.value}),fullWidth:!0,children:[e.jsx(n,{value:"Placements",children:"Placements"}),e.jsx(n,{value:"Gate",children:"Gate"})]}),e.jsxs(r,{select:!0,size:"small",label:"Visibility",value:a.visibility,onChange:s=>i({...a,visibility:s.target.value}),fullWidth:!0,children:[e.jsx(n,{value:"private",children:"Private"}),e.jsx(n,{value:"public",children:"Public"}),e.jsx(n,{value:"group",children:"Group"})]}),e.jsxs(r,{select:!0,size:"small",label:"Availability",value:a.isAvailable?"true":"false",onChange:s=>i({...a,isAvailable:s.target.value==="true"}),fullWidth:!0,children:[e.jsx(n,{value:"true",children:"Available"}),e.jsx(n,{value:"false",children:"Not Available"})]})]}),e.jsx(m,{variant:"contained",color:"primary",onClick:$,disabled:v,className:"mb-8",children:v?"Saving...":"Save Changes"}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h1",{className:"font-medium mb-2 pl-1 text-gray-700",children:"Add New Section"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(r,{size:"small",label:"Section Name",value:o.name,onChange:s=>h({...o,name:s.target.value})}),e.jsxs(r,{size:"small",select:!0,label:"Type",value:o.sectionType,onChange:s=>h({...o,sectionType:s.target.value}),children:[e.jsx(n,{value:"Quiz",children:"Quiz"}),e.jsx(n,{value:"Coding",children:"Coding"})]}),e.jsx(m,{variant:"contained",startIcon:e.jsx(D,{}),onClick:F,disabled:f||!o.name,children:f?"Adding...":"Add Section"})]})]}),e.jsx("h2",{className:"font-semibold pl-1 mt-6 mb-4 text-gray-700 text-lg",children:"Sections"}),a.sections.length===0&&e.jsx("p",{className:"text-gray-500 italic mb-4",children:"No sections added yet."}),a.sections.map(s=>e.jsxs(O,{className:"p-4 mb-4 shadow-sm border rounded-lg bg-white",children:[e.jsx(u,{className:"font-semibold text-lg",children:s.name}),e.jsxs(u,{variant:"body2",color:"textSecondary",children:["Type:"," ",s.sectionType==="Quiz"?`Quiz Questions ${s.questionSet?.length||0}`:`Coding Problems ${s.problemset?.length||0}`]}),e.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[s.sectionType==="Quiz"&&e.jsx(m,{size:"small",variant:"outlined",onClick:()=>E(s._id),children:"Add Questions"}),s.sectionType==="Coding"&&e.jsx(m,{size:"small",variant:"outlined",onClick:()=>M(s._id),children:"Add Problems"}),e.jsxs(W,{children:[e.jsx(L,{children:s.sectionType==="Quiz"?"View Questions":"View Problems"}),e.jsx(V,{children:s.sectionType==="Quiz"?s.questionSet?.length?e.jsx("ul",{className:"list-disc ml-6 space-y-2 text-sm text-gray-800",children:s.questionSet.map((t,c)=>e.jsxs("li",{children:[e.jsx("strong",{children:t.question||`Question ${c+1}`}),e.jsx("br",{}),e.jsx("span",{className:"text-gray-600",children:"Type:"})," ",t.category,e.jsx("br",{}),t.difficulty&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Difficulty:"})," ",t.difficulty,e.jsx("br",{})]}),t.marks&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Marks:"})," ",t.marks]})]},t._id||c))}):e.jsx("p",{className:"text-gray-500 italic",children:"No questions added yet."}):s.problemset?.length?e.jsx("ul",{className:"list-disc ml-6 space-y-2 text-sm text-gray-800",children:s.problemset.map((t,c)=>e.jsxs("li",{children:[e.jsx("strong",{children:t.title||`Problem ${c+1}`}),e.jsx("br",{}),t.difficulty&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Difficulty:"})," ",t.difficulty,e.jsx("br",{})]}),Array.isArray(t.tags)&&t.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Tags:"})," ",t.tags.join(", ")]})]},t._id||c))}):e.jsx("p",{className:"text-gray-500 italic",children:"No problems added yet."})})]})]}),e.jsxs(l.Suspense,{fallback:e.jsx("div",{children:"Loading modal..."}),children:[w===s._id&&s.sectionType==="Quiz"&&e.jsx(R,{open:!0,onClose:A,testId:d,sectionId:s._id,onSuccess:()=>{x(),A()}}),Q===s._id&&s.sectionType==="Coding"&&e.jsx(B,{open:!0,onClose:T,testId:d,sectionId:s._id,onSuccess:()=>{x(),T()}})]})]},s._id))]}):e.jsx(u,{children:"No test found."})}export{ee as default};
