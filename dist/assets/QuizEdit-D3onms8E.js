const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddQuestionAiken-Ed3qvCi9.js","assets/index-BGDZTkRm.js","assets/index-C1ad7qXj.css","assets/index-BnyXeuwH.js","assets/tslib.es6-BYppDQt_.js","assets/UploadFile-BzU2IIpY.js","assets/Button-BS37WqGQ.js","assets/AddQuestionJson-BEg_c6xG.js","assets/AddQuestionExcel-CXlKyEdT.js","assets/xlsx-DSqvgYLF.js"])))=>i.map(i=>d[i]);
import{q as _,j as e,w as q,r as n,I as D,C as F,t as z,B as M,x as T,Y as R,a3 as A}from"./index-BGDZTkRm.js";import{T as m,a as E,S as I}from"./TextField-BYkX3pyg.js";import{M as g}from"./MenuItem-Btq-kwS2.js";import{B as N}from"./Button-BS37WqGQ.js";import{U as Q,C as W}from"./UploadFile-BzU2IIpY.js";import{C as P}from"./Checkbox-B9OWBRC9.js";import{A as U,a as $,b as J}from"./AccordionSummary-DrrcKkxz.js";import{D as L}from"./Delete-DD__mCwF.js";import"./Modal-CBuxXYYs.js";import"./dividerClasses-B_VQpq2S.js";const B=_(e.jsx("path",{d:"m7 10 5 5 5-5z"})),H=_(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96"})),K=o=>{let p=0;for(let x=0;x<o.length;x++)p+=parseInt(o[x].marks);return p};function V({quizId:o,maxMarks:p,onRefresh:x}){const{enqueueSnackbar:f}=q(),c={quizId:o,question:"",image:"",marks:"",category:"",answer:"",negative:"",options:[{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]},[a,r]=n.useState(c),[b,l]=n.useState(""),[h,j]=n.useState(!1),u=i=>{const{name:s,value:t,type:C,files:y}=i.target;if(C==="file"&&y&&y.length>0){const S=y[0];r(O=>({...O,[s]:S})),l(URL.createObjectURL(S))}else r(S=>({...S,[s]:t}))},w=(i,s)=>{const t=[...a.options];t[i].text=s,r({...a,options:t})},k=(i,s)=>{const t=[...a.options];s==="MCQ"?t.forEach((C,y)=>C.isCorrect=y===i):t[i].isCorrect=!t[i].isCorrect,r({...a,options:t})},v=()=>{r(i=>({...i,image:""})),l("")},d=async i=>{if(i.preventDefault(),console.log(a),!a.question||!a.category||parseFloat(a.marks)>p){f("Please fill all required fields correctly!",{variant:"warning"});return}j(!0);const s=new FormData;a.image instanceof File&&s.append("image",a.image),s.append("data",JSON.stringify({quizId:a.quizId,question:a.question,marks:parseFloat(a.marks)||0,category:a.category,answer:a.answer,options:a.options,negative:parseFloat(a.negative)||0}));try{console.log("data"),await z.post(`${M}/api/admin/quiz/add/question`,s,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),f("Question added successfully!",{variant:"success"}),x(),r(c),l("")}catch(t){console.error(t),f("Failed to add question. Try again!",{variant:"error"})}finally{j(!1)}};return e.jsxs("form",{style:{display:"flex",flexDirection:"column",gap:"1rem"},onSubmit:d,className:"space-y-4 bg-white p-5",children:[e.jsx(m,{minRows:2,size:"small",fullWidth:!0,name:"question",label:"Question",multiline:!0,value:a.question,onChange:u,required:!0}),e.jsx(m,{size:"small",fullWidth:!0,name:"marks",type:"number",label:"Marks",value:a.marks,onChange:u,inputProps:{min:0,step:"any"},required:!0}),e.jsx(m,{size:"small",fullWidth:!0,name:"negative",type:"number",label:"Negative Marks",value:a.negative,onChange:u,inputProps:{min:0,step:"any"}}),e.jsxs(m,{size:"small",select:!0,fullWidth:!0,name:"category",label:"Category",value:a.category,onChange:u,required:!0,children:[e.jsx(g,{value:"MCQ",children:"MCQ"}),e.jsx(g,{value:"MSQ",children:"MSQ"}),e.jsx(g,{value:"Text",children:"Text"})]}),a.category==="Text"&&e.jsx(m,{size:"small",fullWidth:!0,name:"answer",label:"Answer",value:a.answer,onChange:u,required:!0}),(a.category==="MCQ"||a.category==="MSQ")&&e.jsx("div",{className:"grid grid-cols-1 gap-2",children:a.options.map((i,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{size:"small",className:"flex-1",label:`Option ${s+1}`,value:i.text,onChange:t=>w(s,t.target.value),required:!0}),a.category==="MCQ"?e.jsx("input",{type:"radio",name:"correctOption",checked:i.isCorrect,onChange:()=>k(s,"MCQ")}):e.jsx("input",{type:"checkbox",checked:i.isCorrect,onChange:()=>k(s,"MSQ")}),"Correct"]},s))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{component:"label",variant:"outlined",startIcon:e.jsx(Q,{}),children:["Upload Image",e.jsx("input",{type:"file",name:"image",hidden:!0,onChange:u})]}),b&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:b,alt:"Preview",className:"h-20 object-contain cursor-pointer",onClick:()=>document.getElementById("image-full")?.requestFullscreen()}),e.jsx(D,{size:"small",onClick:v,children:e.jsx(W,{})})]}),e.jsx("img",{src:b,id:"image-full",className:"hidden",alt:"fullscreen"})]}),e.jsx(N,{type:"submit",variant:"contained",disabled:h,children:h?e.jsx(F,{size:20}):"Add Question"})]})}const Y=n.lazy(()=>A(()=>import("./AddQuestionAiken-Ed3qvCi9.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),G=n.lazy(()=>A(()=>import("./AddQuestionJson-BEg_c6xG.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),X=n.lazy(()=>A(()=>import("./AddQuestionExcel-CXlKyEdT.js"),__vite__mapDeps([8,1,2,3,4,9,5,6]))),de=()=>{const[o,p]=n.useState(!0),[x,f]=n.useState(!1),[c,a]=n.useState(!1),[r,b]=n.useState(null),{slug:l}=R(),[h,j]=n.useState(0),[u,w]=n.useState(0),[k,v]=n.useState(!1),{enqueueSnackbar:d}=q();n.useEffect(()=>{l&&(async()=>{try{const t=await z.get(`${M}/api/admin/quiz/${l}`,{withCredentials:!0});t.data&&b(t.data)}catch(t){console.error(t),d("Failed to load quiz",{variant:"error"})}})()},[l,k,d]),n.useEffect(()=>{r&&(w(r.marks),j(K(r.questions||[])))},[r]);const i=async s=>{try{await z.delete(`${M}/api/admin/quiz/question/del/${r?._id}/${s}`,{withCredentials:!0}),d("Question deleted successfully!",{variant:"success"}),v(t=>!t)}catch(t){console.error(t),d("Failed to delete question",{variant:"error"})}};return r?e.jsxs("section",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center bg-white rounded-md shadow-sm p-6 gap-4",children:[e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Status:"})," ",r.isAvailable?"Available":"Not Available"]}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Current Marks:"})," ",h," / ",u]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(N,{onClick:()=>p(!1),variant:"outlined",startIcon:e.jsx(H,{}),children:"Upload Excel"}),e.jsx(N,{onClick:()=>f(!0),variant:"contained",startIcon:e.jsx(Q,{}),children:"Upload JSON"}),e.jsx(N,{onClick:()=>a(!0),variant:"contained",startIcon:e.jsx(Q,{}),children:"Upload AIKEN"})]})]}),e.jsx(Z,{data:r,onRefresh:()=>v(s=>!s)}),e.jsx(V,{quizId:l,maxMarks:u,currentMarks:h,setCurrentMarks:j,onRefresh:()=>v(s=>!s)}),e.jsxs("section",{className:"bg-white p-6 rounded-md shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Questions"}),r.questions.length>0?r.questions.map((s,t)=>e.jsxs(U,{className:"mb-3 rounded-md border",children:[e.jsx($,{expandIcon:e.jsx(B,{}),sx:{flexDirection:"row-reverse",alignItems:"center"},children:e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsxs("h3",{className:"text-sm font-medium",children:["Question ",t+1,":"," ",e.jsx("span",{className:"ml-2 font-normal",children:s.question})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{onClick:()=>i(s._id),size:"small",children:e.jsx(L,{sx:{color:"gray"}})}),e.jsxs("span",{className:"text-xs text-gray-600",children:[s.marks," Marks"]})]})]})}),e.jsx(J,{children:e.jsxs("div",{className:"px-4 text-sm flex flex-col gap-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.category]}),s.image&&e.jsx("img",{src:s.image,alt:"Question",className:"my-2 h-24 w-auto object-contain rounded-md border"}),s.category==="Text"&&e.jsx(m,{label:"Answer",value:s.answer,variant:"standard",disabled:!0,fullWidth:!0}),(s.category==="MCQ"||s.category==="MSQ")&&s.options?.map((C,y)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Option ",y+1,": ",C.text]}),e.jsx("input",{type:"radio",checked:C.isCorrect,readOnly:!0}),e.jsx("span",{className:"text-xs text-green-600",children:C.isCorrect?"Correct":""})]},y))]})})]},s._id)):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No Questions to display"})]}),!o&&e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"loader"}),children:e.jsx(X,{id:l,setModalClose:p,onSuccess:()=>{d("Excel uploaded successfully!",{variant:"success"}),v(s=>!s)},onError:()=>d("Upload failed",{variant:"error"})})}),x&&e.jsx(G,{id:l,setModalClose:()=>f(!1),onSuccess:()=>{d("JSON uploaded successfully!",{variant:"success"}),v(s=>!s)},onError:()=>d("JSON upload failed",{variant:"error"})}),c&&e.jsx(Y,{id:l,setModalClose:()=>a(!1),onSuccess:()=>{d("AIKEN uploaded successfully!",{variant:"success"}),v(s=>!s)},onError:()=>d("AIKEN upload failed",{variant:"error"})})]}):e.jsx("div",{className:"h-screen w-screen fixed flex justify-center items-center z-[2999]",children:e.jsx(F,{size:"27px"})})},Z=({data:o,onRefresh:p})=>{const x=T(l=>l.auth.user?.user._id),{enqueueSnackbar:f}=q(),[c,a]=n.useState({title:o.title,creator:x,duration:o.duration,marks:o.marks,category:o.category,difficulty:o.difficulty,isAvailable:o.isAvailable}),r=l=>{const{name:h,value:j,type:u,checked:w}=l.target;a(k=>({...k,[h]:u==="checkbox"?w:["marks","duration"].includes(h)?parseInt(j):j}))},b=async l=>{l.preventDefault();try{await z.post(`${M}/api/admin/quiz/edit/${o._id}`,c,{withCredentials:!0}),f("Quiz updated successfully!",{variant:"success"}),p()}catch(h){f("Failed to update quiz",{variant:"error"}),console.error(h)}};return e.jsxs("section",{className:"p-6 bg-white rounded-md shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Edit Quiz Details"}),e.jsxs("form",{onSubmit:b,className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Creator"}),e.jsx(m,{size:"small",type:"text",fullWidth:!0,value:x})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Title"}),e.jsx(m,{size:"small",type:"text",name:"title",fullWidth:!0,value:c.title,onChange:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Marks"}),e.jsx(m,{size:"small",type:"number",name:"marks",value:c.marks,onChange:r,fullWidth:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Duration (min)"}),e.jsx(m,{size:"small",type:"number",name:"duration",value:c.duration,onChange:r,fullWidth:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Category"}),e.jsx(E,{fullWidth:!0,children:e.jsxs(I,{size:"small",name:"category",value:c.category,onChange:r,children:[e.jsx(g,{value:"Aptitude",children:"Aptitude"}),e.jsx(g,{value:"Core",children:"Core"}),e.jsx(g,{value:"Miscellaneous",children:"Miscellaneous"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Difficulty"}),e.jsx(E,{fullWidth:!0,children:e.jsxs(I,{size:"small",name:"difficulty",value:c.difficulty,onChange:r,children:[e.jsx(g,{value:"Easy",children:"Easy"}),e.jsx(g,{value:"Medium",children:"Medium"}),e.jsx(g,{value:"Hard",children:"Hard"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("label",{className:"text-sm font-semibold",children:"Available"}),e.jsx(P,{checked:c.isAvailable,onChange:r,name:"isAvailable"})]}),e.jsx("div",{className:"col-span-full",children:e.jsx(N,{type:"submit",variant:"contained",color:"primary",children:"Update Quiz"})})]})]})};export{Z as QuizEdit,de as default};
