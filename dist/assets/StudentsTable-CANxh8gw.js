import{r as n,ag as P,E as F,F as B,y as E,j as e,S as z,a5 as M,a6 as q,a7 as L,az as O,ap as U,af as u,z as p,aj as W,P as _,ak as K,al as Q,am as g,an as a,ao as G,G as H,I as J,a8 as V,J as X,K as Y,N as Z,O as ee,Q as se,R as C,x as T,B as N}from"./index-Cx2ScfVW.js";const ae=async(l,x,o,h,t,r)=>(await T.get(`${N}/api/campus/students/${l}?page=${x}&limit=${o}&search=${h}&role=${t}&status=${r}`,{withCredentials:!0})).data,ne=()=>{const[l,x]=n.useState(""),[o,h]=n.useState(l),[t,r]=n.useState(1),[i,w]=n.useState("all"),[$,c]=n.useState(!1),[b,y]=n.useState(null),d=10,{id:m}=P(),{enqueueSnackbar:S}=F(),k=B(s=>s.auth.user);n.useEffect(()=>{const s=setTimeout(()=>{h(l),r(1)},400);return()=>clearTimeout(s)},[l]);const{data:f,isLoading:A,refetch:I}=E({queryKey:["students",m,t,o,i],queryFn:()=>ae(m,t,d,o,"all",i)}),R=s=>{y(s),c(!0)},D=async()=>{if(b)try{await T.delete(`${N}/api/campus/students/${m}/${b}`,{withCredentials:!0}),S("Student removed successfully!",{variant:"success"}),I()}catch(s){console.error("Failed to remove student",s),S("Failed to remove student!",{variant:"error"})}finally{c(!1),y(null)}},v=f?.data||[],j=f?.total||0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(z,{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",children:[e.jsx(M,{value:l,onChange:s=>x(s.target.value),size:"small",label:"Search by name or email",InputProps:{startAdornment:e.jsx(q,{position:"start",children:e.jsx(L,{})})},sx:{maxWidth:280}}),k?.user.role=="campus-superadmin"&&e.jsx(O,{size:"small",sx:{minWidth:160},children:e.jsxs(U,{value:i,onChange:s=>w(s.target.value),children:[e.jsx(u,{value:"all",children:"All Statuses"}),e.jsx(u,{value:"member",children:"Member"}),e.jsx(u,{value:"pending",children:"Pending"}),e.jsx(u,{value:"admin",children:"Admin"})]})})]}),A?e.jsx(p,{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(W,{component:_,className:"shadow mt-6 rounded-lg",children:e.jsxs(K,{children:[e.jsx(Q,{className:"bg-orange-50",children:e.jsxs(g,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsxs(G,{children:[v.length===0&&e.jsx(g,{children:e.jsx(a,{colSpan:7,align:"center",children:e.jsx(p,{color:"textSecondary",children:"No students found"})})}),v.map(s=>e.jsxs(g,{hover:!0,children:[e.jsx(a,{children:s.name}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.status==="member"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:"Member"}):s.status==="admin"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded",children:"Admin"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 rounded",children:"Pending"})}),e.jsx(a,{children:e.jsx(H,{title:"Remove Student",children:e.jsx(J,{size:"small",color:"error",onClick:()=>R(s._id),children:e.jsx(V,{})})})})]},s._id))]})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsxs(p,{variant:"body2",color:"textSecondary",children:["Showing ",(t-1)*d+1," - ",Math.min(t*d,j)," of ",j]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:t===1,onClick:()=>r(s=>s-1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:t*d>=j,onClick:()=>r(s=>s+1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})]}),e.jsxs(X,{open:$,onClose:()=>c(!1),children:[e.jsx(Y,{children:"Confirm Removal"}),e.jsx(Z,{children:e.jsx(ee,{children:"Are you sure you want to remove this student? This action cannot be undone."})}),e.jsxs(se,{children:[e.jsx(C,{onClick:()=>c(!1),children:"Cancel"}),e.jsx(C,{color:"error",onClick:D,children:"Remove"})]})]})]})};export{ne as S};
