const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddQuestionAiken-Z6tJkLTU.js","assets/index-D5BKi87E.js","assets/index-BKnduzrB.css","assets/index-mNZcSPu9.js","assets/tslib.es6-BYppDQt_.js","assets/aikenParser-D2gryyxM.js","assets/AddQuestionJson-m66_Kidr.js","assets/AddQuestionExcel-DIjHigIZ.js","assets/xlsx-BTp1RmNK.js"])))=>i.map(i=>d[i]);
import{c as T,j as e,A as E,r,I as x,aj as v,N as S,K as F,al as P,C as R,x as M,B as q,Q as U,aC as _,at as O,ab as $,ak as L,aa as J,aL as I}from"./index-D5BKi87E.js";import{D as W}from"./DeleteConfirmBox-BsDboMQk.js";import{U as D}from"./UploadFile-D0HFZJ5x.js";import{A as B,a as H,b as K}from"./AccordionSummary-Dz6EIla3.js";const V=T(e.jsx("path",{d:"m7 10 5 5 5-5z"})),G=T(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96"})),X=d=>{let j=0;for(let h=0;h<d.length;h++)j+=parseInt(d[h].marks);return j};function Y({quizId:d,maxMarks:j,onRefresh:h}){const{enqueueSnackbar:f}=E(),m={quizId:d,question:"",image:"",marks:"",category:"",answer:"",negative:"",options:[{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]},[s,t]=r.useState(m),[N,i]=r.useState(""),[p,y]=r.useState(!1),[w,k]=r.useState(!1),g=n=>{const{name:l,value:o,type:a,files:c}=n.target;if(a==="file"&&c&&c.length>0){const C=c[0];t(Q=>({...Q,[l]:C})),i(URL.createObjectURL(C))}else t(C=>({...C,[l]:o}))},b=(n,l)=>{const o=[...s.options];o[n].text=l,t({...s,options:o})},u=(n,l)=>{const o=[...s.options];l==="MCQ"?o.forEach((a,c)=>a.isCorrect=c===n):o[n].isCorrect=!o[n].isCorrect,t({...s,options:o})},A=()=>{t(n=>({...n,image:""})),i("")},z=async n=>{if(n.preventDefault(),!s.question||!s.category){f("Please fill all required fields correctly!",{variant:"warning"});return}if(parseFloat(s.marks)>j){f("Mark exceeding allowed limit!",{variant:"warning"});return}y(!0);const l=new FormData;s.image instanceof File&&l.append("image",s.image),l.append("data",JSON.stringify({quizId:s.quizId,question:s.question,marks:parseFloat(s.marks)||0,category:s.category,answer:s.answer,options:s.options,negative:parseFloat(s.negative)||0}));try{await M.post(`${q}/api/admin/quiz/add/question`,l,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),f("Question added successfully!",{variant:"success"}),h(),t(m),i("")}catch(o){console.error(o),f("Failed to add question. Try again!",{variant:"error"})}finally{y(!1)}};return e.jsxs("form",{style:{display:"flex",flexDirection:"column",gap:"1rem"},onSubmit:z,className:"space-y-4 bg-white p-5",children:[e.jsx(x,{minRows:2,size:"small",fullWidth:!0,name:"question",label:"Question",multiline:!0,value:s.question,onChange:g,required:!0}),e.jsx(x,{size:"small",fullWidth:!0,name:"marks",type:"number",label:"Marks",value:s.marks,onChange:g,inputProps:{min:0,step:"any"},required:!0}),e.jsx(x,{size:"small",fullWidth:!0,name:"negative",type:"number",label:"Negative Marks",value:s.negative,onChange:g,inputProps:{min:0,step:"any"}}),e.jsxs(x,{size:"small",select:!0,fullWidth:!0,name:"category",label:"Category",value:s.category,onChange:g,required:!0,children:[e.jsx(v,{value:"MCQ",children:"MCQ"}),e.jsx(v,{value:"MSQ",children:"MSQ"}),e.jsx(v,{value:"Text",children:"Text"})]}),s.category==="Text"&&e.jsx(x,{size:"small",fullWidth:!0,name:"answer",label:"Answer",value:s.answer,onChange:g,required:!0}),(s.category==="MCQ"||s.category==="MSQ")&&e.jsx("div",{className:"grid grid-cols-1 gap-2",children:s.options.map((n,l)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{size:"small",className:"flex-1",label:`Option ${l+1}`,value:n.text,onChange:o=>b(l,o.target.value),required:!0}),s.category==="MCQ"?e.jsx("input",{type:"radio",name:"correctOption",checked:n.isCorrect,onChange:()=>u(l,"MCQ")}):e.jsx("input",{type:"checkbox",checked:n.isCorrect,onChange:()=>u(l,"MSQ")}),"Correct"]},l))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{component:"label",variant:"outlined",startIcon:e.jsx(D,{}),children:["Upload Image",e.jsx("input",{type:"file",name:"image",hidden:!0,onChange:g})]}),N&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:N,alt:"Preview",className:"h-20 object-contain cursor-pointer"}),e.jsx(F,{size:"small",onClick:()=>k(!0),children:e.jsx(P,{})})]})]}),e.jsx(S,{type:"submit",variant:"contained",disabled:p,children:p?e.jsx(R,{size:20}):"Add Question"}),e.jsx(W,{open:w,title:"Remove Image?",message:"This will permanently remove the selected image.",onCancel:()=>k(!1),onConfirm:()=>{A(),k(!1)}})]})}const Z=r.lazy(()=>I(()=>import("./AddQuestionAiken-Z6tJkLTU.js"),__vite__mapDeps([0,1,2,3,4,5]))),ee=r.lazy(()=>I(()=>import("./AddQuestionJson-m66_Kidr.js"),__vite__mapDeps([6,1,2,3,4]))),se=r.lazy(()=>I(()=>import("./AddQuestionExcel-DIjHigIZ.js"),__vite__mapDeps([7,1,2,3,4,8]))),ie=()=>{const[d,j]=r.useState(!0),[h,f]=r.useState(!1),[m,s]=r.useState(!1),[t,N]=r.useState(null),{slug:i}=L(),[p,y]=r.useState(0),[w,k]=r.useState(0),[g,b]=r.useState(!1),{enqueueSnackbar:u}=E(),[A,z]=r.useState(!1),[n,l]=r.useState(null);r.useEffect(()=>{i&&(async()=>{try{const c=await M.get(`${q}/api/admin/quiz/${i}`,{withCredentials:!0});c.data&&N(c.data)}catch(c){console.error(c),u("Failed to load quiz",{variant:"error"})}})()},[i,g,u]),r.useEffect(()=>{t&&(k(t.marks),y(X(t.questions||[])))},[t]);const o=async a=>{try{await M.delete(`${q}/api/admin/quiz/question/del/${t?._id}/${a}`,{withCredentials:!0}),u("Question deleted successfully!",{variant:"success"}),b(c=>!c)}catch(c){console.error(c),u("Failed to delete question",{variant:"error"})}};return t?e.jsxs("section",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center bg-white rounded-md shadow-sm p-6 gap-4",children:[e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Status:"})," ",t.isAvailable?"Available":"Not Available"]}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Current Marks:"})," ",p," / ",w]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(S,{onClick:()=>j(!1),variant:"outlined",startIcon:e.jsx(G,{}),children:"Upload Excel"}),e.jsx(S,{onClick:()=>f(!0),variant:"contained",startIcon:e.jsx(D,{}),children:"Upload JSON"}),e.jsx(S,{onClick:()=>s(!0),variant:"contained",startIcon:e.jsx(D,{}),children:"Upload AIKEN"})]})]}),e.jsx(ae,{data:t,onRefresh:()=>b(a=>!a)}),e.jsx(Y,{quizId:i,maxMarks:w,currentMarks:p,setCurrentMarks:y,onRefresh:()=>b(a=>!a)}),e.jsxs("section",{className:"bg-white p-6 rounded-md shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Questions"}),t.questions.length>0?t.questions.map((a,c)=>e.jsxs(B,{className:"mb-3 rounded-md border",children:[e.jsx(H,{expandIcon:e.jsx(V,{}),children:e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsxs("h3",{className:"text-sm font-medium",children:["Question ",c+1,":"," ",e.jsx("span",{className:"ml-2 font-normal",children:a.question})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{onClick:()=>{l(a._id),z(!0)},size:"small",children:e.jsx(J,{sx:{color:"gray"}})}),e.jsxs("span",{className:"text-xs text-gray-600",children:[a.marks," Marks"]})]})]})}),e.jsx(K,{children:e.jsxs("div",{className:"px-4 text-sm flex flex-col gap-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",a.category]}),a.image&&e.jsx("img",{src:a.image,alt:"Question",className:"my-2 h-24 w-auto object-contain rounded-md border"}),a.category==="Text"&&e.jsx(x,{label:"Answer",value:a.answer,variant:"standard",disabled:!0,fullWidth:!0}),(a.category==="MCQ"||a.category==="MSQ")&&a.options?.map((C,Q)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Option ",Q+1,": ",C.text]}),e.jsx("input",{type:"radio",checked:C.isCorrect,readOnly:!0}),e.jsx("span",{className:"text-xs text-green-600",children:C.isCorrect?"Correct":""})]},Q))]})})]},a._id)):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No Questions to display"})]}),!d&&e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"loader"}),children:e.jsx(se,{id:i,setModalClose:j,onSuccess:()=>{u("Excel uploaded successfully!",{variant:"success"}),b(a=>!a)},onError:()=>u("Upload failed",{variant:"error"})})}),h&&e.jsx(ee,{id:i,setModalClose:()=>f(!1),onSuccess:()=>{u("JSON uploaded successfully!",{variant:"success"}),b(a=>!a)},onError:()=>u("JSON upload failed",{variant:"error"})}),m&&e.jsx(Z,{id:i,setModalClose:()=>s(!1),onSuccess:()=>{u("AIKEN uploaded successfully!",{variant:"success"}),b(a=>!a)},onError:()=>u("AIKEN upload failed",{variant:"error"})}),e.jsx(W,{open:A,title:"Delete Question?",message:"This question will be permanently removed from the quiz.",onCancel:()=>{z(!1),l(null)},onConfirm:()=>{n&&o(n),z(!1),l(null)}})]}):e.jsx("div",{className:"h-screen w-screen fixed flex justify-center items-center z-[2999]",children:e.jsx(R,{size:"27px"})})},ae=({data:d,onRefresh:j})=>{const h=U(i=>i.auth.user?.user._id),{enqueueSnackbar:f}=E(),[m,s]=r.useState({title:d.title,creator:h,duration:d.duration,marks:d.marks,category:d.category,difficulty:d.difficulty,isAvailable:d.isAvailable}),t=i=>{const{name:p,value:y,type:w,checked:k}=i.target;s(g=>({...g,[p]:w==="checkbox"?k:["marks","duration"].includes(p)?parseInt(y):y}))},N=async i=>{i.preventDefault();try{await M.post(`${q}/api/admin/quiz/edit/${d._id}`,m,{withCredentials:!0}),f("Quiz updated successfully!",{variant:"success"}),j()}catch(p){f("Failed to update quiz",{variant:"error"}),console.error(p)}};return e.jsxs("section",{className:"p-6 bg-white rounded-md shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Edit Quiz Details"}),e.jsxs("form",{onSubmit:N,className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Creator"}),e.jsx(x,{size:"small",type:"text",fullWidth:!0,value:h})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Title"}),e.jsx(x,{size:"small",type:"text",name:"title",fullWidth:!0,value:m.title,onChange:t})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Marks"}),e.jsx(x,{size:"small",type:"number",name:"marks",value:m.marks,onChange:t,fullWidth:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Duration (min)"}),e.jsx(x,{size:"small",type:"number",name:"duration",value:m.duration,onChange:t,fullWidth:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Category"}),e.jsx(_,{fullWidth:!0,children:e.jsxs(O,{size:"small",name:"category",value:m.category,onChange:t,children:[e.jsx(v,{value:"Aptitude",children:"Aptitude"}),e.jsx(v,{value:"Core",children:"Core"}),e.jsx(v,{value:"Miscellaneous",children:"Miscellaneous"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Difficulty"}),e.jsx(_,{fullWidth:!0,children:e.jsxs(O,{size:"small",name:"difficulty",value:m.difficulty,onChange:t,children:[e.jsx(v,{value:"Easy",children:"Easy"}),e.jsx(v,{value:"Medium",children:"Medium"}),e.jsx(v,{value:"Hard",children:"Hard"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("label",{className:"text-sm font-semibold",children:"Available"}),e.jsx($,{checked:m.isAvailable,onChange:t,name:"isAvailable"})]}),e.jsx("div",{className:"col-span-full",children:e.jsx(S,{type:"submit",variant:"contained",children:"Update Quiz"})})]})]})};export{ae as QuizEdit,ie as default};
