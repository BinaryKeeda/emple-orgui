import{r as l,a0 as C,j as e,z as $,x as I,I as P,t as y,B as S}from"./index-BvY5VVbY.js";import{u as A}from"./useQuery-CU89VrzA.js";import{T as R,a as B,S as E}from"./TextField-CLpIsOvn.js";import{I as F,S as M,T as z,a as k,b as D,c as p,d as t,e as L}from"./Search-BQtfObKY.js";import{M as c}from"./MenuItem-DcHrkjhF.js";import{T as j}from"./Typography-C7tJ6m3F.js";import{P as W}from"./Modal-D47ud7EH.js";import{D as _}from"./Delete-CNH86uxD.js";const q=async(n,m,i,x,a,r)=>(await y.get(`${S}/api/campus/students/${n}?page=${m}&limit=${i}&search=${x}&role=${a}&status=${r}`,{withCredentials:!0})).data,X=()=>{const[n,m]=l.useState(""),[i,x]=l.useState(n),[a,r]=l.useState(1),[d,f]=l.useState("all"),o=10,{id:h}=C();l.useEffect(()=>{const s=setTimeout(()=>{x(n),r(1)},400);return()=>clearTimeout(s)},[n]);const{data:b,isLoading:v,refetch:T}=A({queryKey:["students",h,a,i,d],queryFn:()=>q(h,a,o,i,"all",d)}),N=async s=>{try{await y.delete(`${S}/api/campus/students/${h}/${s}`,{withCredentials:!0}),T()}catch(w){console.error("Failed to remove student",w)}},g=b?.data||[],u=b?.total||0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs($,{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",children:[e.jsx(R,{value:n,onChange:s=>m(s.target.value),size:"small",label:"Search by name or email",InputProps:{startAdornment:e.jsx(F,{position:"start",children:e.jsx(M,{})})},sx:{maxWidth:280}}),e.jsx(B,{size:"small",sx:{minWidth:160},children:e.jsxs(E,{value:d,onChange:s=>f(s.target.value),children:[e.jsx(c,{value:"all",children:"All Statuses"}),e.jsx(c,{value:"member",children:"Member"}),e.jsx(c,{value:"pending",children:"Pending"}),e.jsx(c,{value:"admin",children:"Admin"})]})})]}),v?e.jsx(j,{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(z,{component:W,className:"shadow mt-6 rounded-lg",children:e.jsxs(k,{children:[e.jsx(D,{className:"bg-orange-50",children:e.jsxs(p,{children:[e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Role"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsxs(L,{children:[g.length===0&&e.jsx(p,{children:e.jsx(t,{colSpan:7,align:"center",children:e.jsx(j,{color:"textSecondary",children:"No students found"})})}),g.map(s=>e.jsxs(p,{hover:!0,children:[e.jsx(t,{children:s.name}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.role}),e.jsx(t,{children:s.status==="member"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:"Member"}):s.status==="admin"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded",children:"Admin"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 rounded",children:"Pending"})}),e.jsx(t,{children:e.jsx(I,{title:"Remove Student",children:e.jsx(P,{size:"small",color:"error",onClick:()=>N(s._id),children:e.jsx(_,{})})})})]},s._id))]})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsxs(j,{variant:"body2",color:"textSecondary",children:["Showing ",(a-1)*o+1," - ",Math.min(a*o,u)," of ",u]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:a===1,onClick:()=>r(s=>s-1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:a*o>=u,onClick:()=>r(s=>s+1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})]})]})};export{X as S};
