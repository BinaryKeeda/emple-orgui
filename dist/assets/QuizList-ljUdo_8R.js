import{ak as B,r as t,A as I,ai as L,y as _,j as e,P as q,I as F,J as O,a8 as K,an as N,ao as V,ap as W,aq as d,ar as a,as as G,S as h,K as j,ax as z,V as H,ay as J,aa as M,au as U,E as X,F as Y,G as Z,W as ee,L as se,N as C,x as S,B as P}from"./index-B9af5AVi.js";const ae=async({sectionId:n,page:i,limit:l,search:r})=>(await S.get(`${P}/api/campus/quiz/get/section/${n}`,{params:{page:i,limit:l,search:r},withCredentials:!0})).data,ne=()=>{const{id:n}=B(),[i,l]=t.useState(0),[r,g]=t.useState(10),[o,D]=t.useState(""),[u,T]=t.useState(o),[b,c]=t.useState(!1),[x,m]=t.useState(null),{enqueueSnackbar:p}=I(),w=L();t.useEffect(()=>{const s=setTimeout(()=>{T(o),l(0)},400);return()=>clearTimeout(s)},[o]);const{data:f,isLoading:v}=_({queryKey:["quizzes",n,i,r,u],queryFn:()=>ae({sectionId:n,page:i+1,limit:r,search:u}),enabled:!!n,staleTime:1e3*60*5}),y=f?.quizzes??[],Q=f?.totalQuizzes??0,k=(s,$)=>l($),A=s=>{g(parseInt(s.target.value,10)),l(0)},E=s=>{m(s),c(!0)},R=async()=>{if(x)try{await S.delete(`${P}/api/campus/sections/quiz/delete/${x._id}`,{withCredentials:!0}),p("Quiz deleted successfully",{variant:"success"}),w.invalidateQueries({queryKey:["quizzes",n,i,r,u]})}catch{p("Failed to delete quiz",{variant:"error"})}finally{c(!1),m(null)}};return e.jsxs(q,{sx:{p:3,borderRadius:3,overflow:"hidden"},children:[e.jsx(F,{size:"small",placeholder:"Search quizzes...",value:o,onChange:s=>D(s.target.value),sx:{mb:2,width:"100%",maxWidth:400},InputProps:{startAdornment:e.jsx(O,{position:"start",children:e.jsx(K,{})})}}),e.jsx(N,{children:e.jsxs(V,{children:[e.jsx(W,{children:e.jsxs(d,{children:[e.jsx(a,{children:"Title"}),e.jsx(a,{children:"Category"}),e.jsx(a,{children:"Difficulty"}),e.jsx(a,{children:"Duration"}),e.jsx(a,{children:"Marks"}),e.jsx(a,{children:"Created By"}),e.jsx(a,{children:"Cost"}),e.jsx(a,{align:"center",children:"Actions"}),e.jsx(a,{align:"center",children:"Delete"})]})}),e.jsx(G,{children:v?e.jsx(d,{children:e.jsx(a,{colSpan:9,align:"center",children:"Loading..."})}):y.length===0?e.jsx(d,{children:e.jsx(a,{colSpan:9,align:"center",children:"No quizzes found."})}):y.map(s=>e.jsxs(d,{hover:!0,children:[e.jsx(a,{children:s.title}),e.jsx(a,{children:s.category}),e.jsx(a,{children:s.difficulty}),e.jsxs(a,{children:[s.duration," min"]}),e.jsx(a,{children:s.marks}),e.jsx(a,{children:s.creator?.name||"-"}),e.jsx(a,{children:e.jsx(h,{title:`Total: ${s.costPerAttempt*s.noOfSubmissions}`,arrow:!0,children:e.jsx("span",{children:(s.costPerAttempt||0)*(s.noOfSubmissions||0)})})}),e.jsxs(a,{align:"center",children:[e.jsx(h,{title:"Preview Quiz",children:e.jsx(j,{component:z,to:`preview/${s.slug}`,color:"primary",size:"small",children:e.jsx(H,{fontSize:"small"})})}),e.jsx(h,{title:"Edit Quiz",children:e.jsx(j,{component:z,to:`edit/${s._id}`,color:"warning",size:"small",children:e.jsx(J,{fontSize:"small"})})})]}),e.jsx(a,{align:"center",children:e.jsx(h,{title:"Delete Quiz",children:e.jsx(j,{color:"error",size:"small",onClick:()=>E(s),children:e.jsx(M,{fontSize:"small"})})})})]},s._id))})]})}),e.jsx(U,{component:"div",count:Q,page:i,onPageChange:k,rowsPerPage:r,onRowsPerPageChange:A,rowsPerPageOptions:[5,10,20,50]}),e.jsxs(X,{open:b,onClose:()=>c(!1),children:[e.jsx(Y,{children:"Confirm Deletion"}),e.jsx(Z,{children:e.jsxs(ee,{children:['Are you sure you want to delete quiz "',x?.title,'"? This action cannot be undone.']})}),e.jsxs(se,{children:[e.jsx(C,{onClick:()=>c(!1),color:"inherit",children:"Cancel"}),e.jsx(C,{onClick:R,color:"error",variant:"contained",children:"Delete"})]})]})]})};export{ne as default};
