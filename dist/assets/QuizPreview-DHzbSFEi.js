import{$ as y,r as x,j as e,t as u,B as g}from"./index-Dm6XyL4l.js";import{u as j}from"./useQuery-BbZ0NZ13.js";const N=async({slug:a,id:t,page:r})=>(await u.get(`${g}/api/campus/quiz/submissions/${a}/${t}`,{params:{page:r},withCredentials:!0})).data,w=()=>{const{slug:a,id:t}=y(),[r,d]=x.useState(1),[o,b]=x.useState(!1),{data:l,isLoading:m,isError:h,refetch:p}=j({queryKey:["quizPreview",a,t,r],queryFn:()=>N({slug:a,id:t,page:r}),enabled:!!a&&!!t,staleTime:1e3*60*5});if(m)return e.jsx("div",{className:"text-center py-10",children:"Loading..."});if(h)return e.jsxs("div",{className:"text-center py-10 text-red-500",children:["Failed to fetch data.",e.jsx("button",{onClick:()=>p(),className:"ml-2 underline text-indigo-600",children:"Retry"})]});const c=l?.submissions?.list??[],n=l?.defaulters?.list??[],i=l?.submissions?.totalPages??1;return e.jsxs("div",{className:"p-6 flex flex-col gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Submissions"}),e.jsx("div",{className:"overflow-x-auto bg-white rounded-xl shadow-md",children:e.jsxs("table",{className:"w-full text-sm text-left border border-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 border-b border-b-gray-200",children:"Name"}),e.jsx("th",{className:"px-4 py-3 border-b border-b-gray-200",children:"Email"}),e.jsx("th",{className:"px-4 py-3 border-b border-b-gray-200",children:"Attempt"}),e.jsx("th",{className:"px-4 py-3 border-b border-b-gray-200",children:"Score"}),e.jsx("th",{className:"px-4 py-3 border-b border-b-gray-200",children:"Submitted At"})]})}),e.jsxs("tbody",{children:[c.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4 border-b border-b-gray-50",children:s.userId?.name}),e.jsx("td",{className:"px-4 py-4 border-b border-b-gray-50",children:s.userId?.email}),e.jsx("td",{className:"px-4 py-4 border-b border-b-gray-50",children:s.attemptNo}),e.jsx("td",{className:"px-4 py-4 border-b border-b-gray-50",children:s.score}),e.jsx("td",{className:"px-4 py-4 border-b border-b-gray-50",children:new Date(s.submittedAt).toLocaleString()})]},s._id)),c.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-6 text-gray-500",children:"No submissions found."})})]})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Page ",r," of ",i]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:()=>d(s=>Math.max(s-1,1)),disabled:r===1,className:"px-3 py-1 text-sm border rounded-md disabled:opacity-50 hover:bg-gray-100",children:"Prev"}),e.jsx("button",{onClick:()=>d(s=>Math.min(s+1,i)),disabled:r===i,className:"px-3 py-1 text-sm border rounded-md disabled:opacity-50 hover:bg-gray-100",children:"Next"})]})]})]}),e.jsx("button",{onClick:()=>b(s=>!s),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:o?"Hide Defaulters":"Show Defaulters"}),o&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Defaulters"}),e.jsx("div",{className:"overflow-x-auto bg-white rounded-xl shadow-md",children:e.jsxs("table",{className:"w-full text-sm text-left border border-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 border-b border-b-gray-200",children:"Name"}),e.jsx("th",{className:"px-4 py-3 border-b border-b-gray-200",children:"Email"})]})}),e.jsxs("tbody",{children:[n.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-4 border-b border-b-gray-50",children:s.name}),e.jsx("td",{className:"px-4 py-4 border-b border-b-gray-50",children:s.email})]},s._id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"text-center py-6 text-gray-500",children:"No defaulters found."})})]})]})})]})]})};export{w as default};
