const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddQuestionAiken-B2L93wjb.js","assets/index-BwMterpV.js","assets/index-B0jEptJo.css","assets/index-CR3a4HT1.js","assets/tslib.es6-BYppDQt_.js","assets/AddQuestionJson-B7rXXogH.js","assets/AddQuestionExcel-BkjVQnPp.js","assets/xlsx-DSqvgYLF.js"])))=>i.map(i=>d[i]);
import{w as _,j as e,E as q,r as i,a5 as m,af as g,R as N,I as D,ah as R,C as F,x as z,B as M,F as T,az as E,ap as I,aH as W,ag as P,a8 as U,aJ as A}from"./index-BwMterpV.js";import{U as Q}from"./UploadFile-D_ZgjxwB.js";import{A as $,a as J,b as L}from"./AccordionSummary-BR7A7edA.js";const H=_(e.jsx("path",{d:"m7 10 5 5 5-5z"})),B=_(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96"})),K=o=>{let f=0;for(let x=0;x<o.length;x++)f+=parseInt(o[x].marks);return f};function V({quizId:o,maxMarks:f,onRefresh:x}){const{enqueueSnackbar:p}=q(),c={quizId:o,question:"",image:"",marks:"",category:"",answer:"",negative:"",options:[{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]},[a,l]=i.useState(c),[b,r]=i.useState(""),[h,j]=i.useState(!1),u=n=>{const{name:s,value:t,type:C,files:y}=n.target;if(C==="file"&&y&&y.length>0){const S=y[0];l(O=>({...O,[s]:S})),r(URL.createObjectURL(S))}else l(S=>({...S,[s]:t}))},w=(n,s)=>{const t=[...a.options];t[n].text=s,l({...a,options:t})},k=(n,s)=>{const t=[...a.options];s==="MCQ"?t.forEach((C,y)=>C.isCorrect=y===n):t[n].isCorrect=!t[n].isCorrect,l({...a,options:t})},v=()=>{l(n=>({...n,image:""})),r("")},d=async n=>{if(n.preventDefault(),console.log(a),!a.question||!a.category||parseFloat(a.marks)>f){p("Please fill all required fields correctly!",{variant:"warning"});return}j(!0);const s=new FormData;a.image instanceof File&&s.append("image",a.image),s.append("data",JSON.stringify({quizId:a.quizId,question:a.question,marks:parseFloat(a.marks)||0,category:a.category,answer:a.answer,options:a.options,negative:parseFloat(a.negative)||0}));try{console.log("data"),await z.post(`${M}/api/admin/quiz/add/question`,s,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),p("Question added successfully!",{variant:"success"}),x(),l(c),r("")}catch(t){console.error(t),p("Failed to add question. Try again!",{variant:"error"})}finally{j(!1)}};return e.jsxs("form",{style:{display:"flex",flexDirection:"column",gap:"1rem"},onSubmit:d,className:"space-y-4 bg-white p-5",children:[e.jsx(m,{minRows:2,size:"small",fullWidth:!0,name:"question",label:"Question",multiline:!0,value:a.question,onChange:u,required:!0}),e.jsx(m,{size:"small",fullWidth:!0,name:"marks",type:"number",label:"Marks",value:a.marks,onChange:u,inputProps:{min:0,step:"any"},required:!0}),e.jsx(m,{size:"small",fullWidth:!0,name:"negative",type:"number",label:"Negative Marks",value:a.negative,onChange:u,inputProps:{min:0,step:"any"}}),e.jsxs(m,{size:"small",select:!0,fullWidth:!0,name:"category",label:"Category",value:a.category,onChange:u,required:!0,children:[e.jsx(g,{value:"MCQ",children:"MCQ"}),e.jsx(g,{value:"MSQ",children:"MSQ"}),e.jsx(g,{value:"Text",children:"Text"})]}),a.category==="Text"&&e.jsx(m,{size:"small",fullWidth:!0,name:"answer",label:"Answer",value:a.answer,onChange:u,required:!0}),(a.category==="MCQ"||a.category==="MSQ")&&e.jsx("div",{className:"grid grid-cols-1 gap-2",children:a.options.map((n,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{size:"small",className:"flex-1",label:`Option ${s+1}`,value:n.text,onChange:t=>w(s,t.target.value),required:!0}),a.category==="MCQ"?e.jsx("input",{type:"radio",name:"correctOption",checked:n.isCorrect,onChange:()=>k(s,"MCQ")}):e.jsx("input",{type:"checkbox",checked:n.isCorrect,onChange:()=>k(s,"MSQ")}),"Correct"]},s))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{component:"label",variant:"outlined",startIcon:e.jsx(Q,{}),children:["Upload Image",e.jsx("input",{type:"file",name:"image",hidden:!0,onChange:u})]}),b&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:b,alt:"Preview",className:"h-20 object-contain cursor-pointer",onClick:()=>document.getElementById("image-full")?.requestFullscreen()}),e.jsx(D,{size:"small",onClick:v,children:e.jsx(R,{})})]}),e.jsx("img",{src:b,id:"image-full",className:"hidden",alt:"fullscreen"})]}),e.jsx(N,{type:"submit",variant:"contained",disabled:h,children:h?e.jsx(F,{size:20}):"Add Question"})]})}const G=i.lazy(()=>A(()=>import("./AddQuestionAiken-B2L93wjb.js"),__vite__mapDeps([0,1,2,3,4]))),X=i.lazy(()=>A(()=>import("./AddQuestionJson-B7rXXogH.js"),__vite__mapDeps([5,1,2,3,4]))),Y=i.lazy(()=>A(()=>import("./AddQuestionExcel-BkjVQnPp.js"),__vite__mapDeps([6,1,2,3,4,7]))),te=()=>{const[o,f]=i.useState(!0),[x,p]=i.useState(!1),[c,a]=i.useState(!1),[l,b]=i.useState(null),{slug:r}=P(),[h,j]=i.useState(0),[u,w]=i.useState(0),[k,v]=i.useState(!1),{enqueueSnackbar:d}=q();i.useEffect(()=>{r&&(async()=>{try{const t=await z.get(`${M}/api/admin/quiz/${r}`,{withCredentials:!0});t.data&&b(t.data)}catch(t){console.error(t),d("Failed to load quiz",{variant:"error"})}})()},[r,k,d]),i.useEffect(()=>{l&&(w(l.marks),j(K(l.questions||[])))},[l]);const n=async s=>{try{await z.delete(`${M}/api/admin/quiz/question/del/${l?._id}/${s}`,{withCredentials:!0}),d("Question deleted successfully!",{variant:"success"}),v(t=>!t)}catch(t){console.error(t),d("Failed to delete question",{variant:"error"})}};return l?e.jsxs("section",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center bg-white rounded-md shadow-sm p-6 gap-4",children:[e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Status:"})," ",l.isAvailable?"Available":"Not Available"]}),e.jsxs("span",{className:"text-gray-600",children:[e.jsx("strong",{children:"Current Marks:"})," ",h," / ",u]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(N,{onClick:()=>f(!1),variant:"outlined",startIcon:e.jsx(B,{}),children:"Upload Excel"}),e.jsx(N,{onClick:()=>p(!0),variant:"contained",startIcon:e.jsx(Q,{}),children:"Upload JSON"}),e.jsx(N,{onClick:()=>a(!0),variant:"contained",startIcon:e.jsx(Q,{}),children:"Upload AIKEN"})]})]}),e.jsx(Z,{data:l,onRefresh:()=>v(s=>!s)}),e.jsx(V,{quizId:r,maxMarks:u,currentMarks:h,setCurrentMarks:j,onRefresh:()=>v(s=>!s)}),e.jsxs("section",{className:"bg-white p-6 rounded-md shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Questions"}),l.questions.length>0?l.questions.map((s,t)=>e.jsxs($,{className:"mb-3 rounded-md border",children:[e.jsx(J,{expandIcon:e.jsx(H,{}),sx:{flexDirection:"row-reverse",alignItems:"center"},children:e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsxs("h3",{className:"text-sm font-medium",children:["Question ",t+1,":"," ",e.jsx("span",{className:"ml-2 font-normal",children:s.question})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{onClick:()=>n(s._id),size:"small",children:e.jsx(U,{sx:{color:"gray"}})}),e.jsxs("span",{className:"text-xs text-gray-600",children:[s.marks," Marks"]})]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"px-4 text-sm flex flex-col gap-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",s.category]}),s.image&&e.jsx("img",{src:s.image,alt:"Question",className:"my-2 h-24 w-auto object-contain rounded-md border"}),s.category==="Text"&&e.jsx(m,{label:"Answer",value:s.answer,variant:"standard",disabled:!0,fullWidth:!0}),(s.category==="MCQ"||s.category==="MSQ")&&s.options?.map((C,y)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Option ",y+1,": ",C.text]}),e.jsx("input",{type:"radio",checked:C.isCorrect,readOnly:!0}),e.jsx("span",{className:"text-xs text-green-600",children:C.isCorrect?"Correct":""})]},y))]})})]},s._id)):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No Questions to display"})]}),!o&&e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"loader"}),children:e.jsx(Y,{id:r,setModalClose:f,onSuccess:()=>{d("Excel uploaded successfully!",{variant:"success"}),v(s=>!s)},onError:()=>d("Upload failed",{variant:"error"})})}),x&&e.jsx(X,{id:r,setModalClose:()=>p(!1),onSuccess:()=>{d("JSON uploaded successfully!",{variant:"success"}),v(s=>!s)},onError:()=>d("JSON upload failed",{variant:"error"})}),c&&e.jsx(G,{id:r,setModalClose:()=>a(!1),onSuccess:()=>{d("AIKEN uploaded successfully!",{variant:"success"}),v(s=>!s)},onError:()=>d("AIKEN upload failed",{variant:"error"})})]}):e.jsx("div",{className:"h-screen w-screen fixed flex justify-center items-center z-[2999]",children:e.jsx(F,{size:"27px"})})},Z=({data:o,onRefresh:f})=>{const x=T(r=>r.auth.user?.user._id),{enqueueSnackbar:p}=q(),[c,a]=i.useState({title:o.title,creator:x,duration:o.duration,marks:o.marks,category:o.category,difficulty:o.difficulty,isAvailable:o.isAvailable}),l=r=>{const{name:h,value:j,type:u,checked:w}=r.target;a(k=>({...k,[h]:u==="checkbox"?w:["marks","duration"].includes(h)?parseInt(j):j}))},b=async r=>{r.preventDefault();try{await z.post(`${M}/api/admin/quiz/edit/${o._id}`,c,{withCredentials:!0}),p("Quiz updated successfully!",{variant:"success"}),f()}catch(h){p("Failed to update quiz",{variant:"error"}),console.error(h)}};return e.jsxs("section",{className:"p-6 bg-white rounded-md shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Edit Quiz Details"}),e.jsxs("form",{onSubmit:b,className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Creator"}),e.jsx(m,{size:"small",type:"text",fullWidth:!0,value:x})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Title"}),e.jsx(m,{size:"small",type:"text",name:"title",fullWidth:!0,value:c.title,onChange:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Marks"}),e.jsx(m,{size:"small",type:"number",name:"marks",value:c.marks,onChange:l,fullWidth:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Duration (min)"}),e.jsx(m,{size:"small",type:"number",name:"duration",value:c.duration,onChange:l,fullWidth:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Category"}),e.jsx(E,{fullWidth:!0,children:e.jsxs(I,{size:"small",name:"category",value:c.category,onChange:l,children:[e.jsx(g,{value:"Aptitude",children:"Aptitude"}),e.jsx(g,{value:"Core",children:"Core"}),e.jsx(g,{value:"Miscellaneous",children:"Miscellaneous"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Difficulty"}),e.jsx(E,{fullWidth:!0,children:e.jsxs(I,{size:"small",name:"difficulty",value:c.difficulty,onChange:l,children:[e.jsx(g,{value:"Easy",children:"Easy"}),e.jsx(g,{value:"Medium",children:"Medium"}),e.jsx(g,{value:"Hard",children:"Hard"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("label",{className:"text-sm font-semibold",children:"Available"}),e.jsx(W,{checked:c.isAvailable,onChange:l,name:"isAvailable"})]}),e.jsx("div",{className:"col-span-full",children:e.jsx(N,{type:"submit",variant:"contained",color:"primary",children:"Update Quiz"})})]})]})};export{Z as QuizEdit,te as default};
