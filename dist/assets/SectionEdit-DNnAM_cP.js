import{U as Oe,V as Ue,r as a,W as He,F as Qe,g as te,a as re,q as $,j as e,u as ae,b as T,s as L,c as ne,I as je,d as z,e as le,m as ie,f as be,i as _e,k as Ve,G as ke,H as ye,h as Pe,X as Ye,Y as Ge,J as Ae,Z as Ee,_ as Xe,$ as Ke,z as J,t as me,B as he,C as we,w as Me,a0 as We}from"./index-BvY5VVbY.js";import{P as ce,F as Re,M as Te,B as qe}from"./Modal-D47ud7EH.js";import{T as I,F as Je,S as Ze}from"./TextField-CLpIsOvn.js";import{M as H}from"./MenuItem-DcHrkjhF.js";import{B as ee}from"./Button-3qkbKROX.js";import{T as pe}from"./Typography-C7tJ6m3F.js";import{u as et}from"./useQuery-CU89VrzA.js";import{r as tt,u as ue,w as st}from"./xlsx-DSqvgYLF.js";import{g as Ne}from"./userSelector-C6liUQHe.js";import{C as ot,U as nt}from"./UploadFile-Bhng2Bha.js";import{T as rt,a as at,b as lt,c as Ce,d as _,e as it}from"./Search-BQtfObKY.js";import{D as ct}from"./Delete-CNH86uxD.js";import{T as dt}from"./TablePagination-CI6cDVJU.js";import{S as ut}from"./StudentsTable-BM2bbonQ.js";import"./dividerClasses-bfELzNQK.js";function pt(t){const{theme:s,name:n,props:o}=t;return!s||!s.components||!s.components[n]||!s.components[n].defaultProps?o:Oe(s.components[n].defaultProps,o)}function mt(t,s,n,o,i){const[r,h]=a.useState(()=>i&&n?n(t).matches:o?o(t).matches:s);return Qe(()=>{if(!n)return;const c=n(t),d=()=>{h(c.matches)};return d(),c.addEventListener("change",d),()=>{c.removeEventListener("change",d)}},[t,n]),r}const ht={...He},$e=ht.useSyncExternalStore;function ft(t,s,n,o,i){const r=a.useCallback(()=>s,[s]),h=a.useMemo(()=>{if(i&&n)return()=>n(t).matches;if(o!==null){const{matches:l}=o(t);return()=>l}return r},[r,t,o,i,n]),[c,d]=a.useMemo(()=>{if(n===null)return[r,()=>()=>{}];const l=n(t);return[()=>l.matches,m=>(l.addEventListener("change",m),()=>{l.removeEventListener("change",m)})]},[r,n,t]);return $e(d,c,h)}function Fe(t={}){const{themeId:s}=t;return function(o,i={}){let r=Ue();r&&s&&(r=r[s]||r);const h=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:c=!1,matchMedia:d=h?window.matchMedia:null,ssrMatchMedia:g=null,noSsr:l=!1}=pt({name:"MuiUseMediaQuery",props:i,theme:r});let m=typeof o=="function"?o(r):o;return m=m.replace(/^@media( ?)/m,""),m.includes("print")&&console.warn(["MUI: You have provided a `print` query to the `useMediaQuery` hook.","Using the print media query to modify print styles can lead to unexpected results.","Consider using the `displayPrint` field in the `sx` prop instead.","More information about `displayPrint` on our docs: https://mui.com/system/display/#display-in-print."].join(`
`)),($e!==void 0?ft:mt)(m,c,d,g,l)}}Fe();function gt(t){return re("MuiAlert",t)}const ze=te("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),xt=$(e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),vt=$(e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),bt=$(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),yt=$(e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),Ct=$(e.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),St=t=>{const{variant:s,color:n,severity:o,classes:i}=t,r={root:["root",`color${z(n||o)}`,`${s}${z(n||o)}`,`${s}`],icon:["icon"],message:["message"],action:["action"]};return le(r,gt,i)},jt=L(ce,{name:"MuiAlert",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:n}=t;return[s.root,s[n.variant],s[`${n.variant}${z(n.color||n.severity)}`]]}})(ie(({theme:t})=>{const s=t.palette.mode==="light"?t.darken:t.lighten,n=t.palette.mode==="light"?t.lighten:t.darken;return{...t.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(be(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:s(t.palette[o].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${o}StandardBg`]:n(t.palette[o].light,.9),[`& .${ze.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(be(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:s(t.palette[o].light,.6),border:`1px solid ${(t.vars||t).palette[o].light}`,[`& .${ze.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(be(["dark"])).map(([o])=>({props:{colorSeverity:o,variant:"filled"},style:{fontWeight:t.typography.fontWeightMedium,...t.vars?{color:t.vars.palette.Alert[`${o}FilledColor`],backgroundColor:t.vars.palette.Alert[`${o}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[o].dark:t.palette[o].main,color:t.palette.getContrastText(t.palette[o].main)}}}))]}})),kt=L("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),wt=L("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),Mt=L("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),Le={success:e.jsx(xt,{fontSize:"inherit"}),warning:e.jsx(vt,{fontSize:"inherit"}),error:e.jsx(bt,{fontSize:"inherit"}),info:e.jsx(yt,{fontSize:"inherit"})},Pt=a.forwardRef(function(s,n){const o=ae({props:s,name:"MuiAlert"}),{action:i,children:r,className:h,closeText:c="Close",color:d,components:g={},componentsProps:l={},icon:m,iconMapping:C=Le,onClose:y,role:u="alert",severity:v="success",slotProps:x={},slots:p={},variant:b="standard",...w}=o,S={...o,color:d,severity:v,variant:b,colorSeverity:d||v},D=St(S),W={slots:{closeButton:g.CloseButton,closeIcon:g.CloseIcon,...p},slotProps:{...l,...x}},[V,K]=T("root",{ref:n,shouldForwardComponentProp:!0,className:ne(D.root,h),elementType:jt,externalForwardedProps:{...W,...w},ownerState:S,additionalProps:{role:u,elevation:0}}),[Y,F]=T("icon",{className:D.icon,elementType:kt,externalForwardedProps:W,ownerState:S}),[G,X]=T("message",{className:D.message,elementType:wt,externalForwardedProps:W,ownerState:S}),[E,B]=T("action",{className:D.action,elementType:Mt,externalForwardedProps:W,ownerState:S}),[M,q]=T("closeButton",{elementType:je,externalForwardedProps:W,ownerState:S}),[O,f]=T("closeIcon",{elementType:Ct,externalForwardedProps:W,ownerState:S});return e.jsxs(V,{...K,children:[m!==!1?e.jsx(Y,{...F,children:m||C[v]||Le[v]}):null,e.jsx(G,{...X,children:r}),i!=null?e.jsx(E,{...B,children:i}):null,i==null&&y?e.jsx(E,{...B,children:e.jsx(M,{size:"small","aria-label":c,title:c,color:"inherit",onClick:y,...q,children:e.jsx(O,{fontSize:"small",...f})})}):null]})});function De(t){return t.substring(2).toLowerCase()}function Tt(t,s){return s.documentElement.clientWidth<t.clientX||s.documentElement.clientHeight<t.clientY}function At(t){const{children:s,disableReactTree:n=!1,mouseEvent:o="onClick",onClickAway:i,touchEvent:r="onTouchEnd"}=t,h=a.useRef(!1),c=a.useRef(null),d=a.useRef(!1),g=a.useRef(!1);a.useEffect(()=>(setTimeout(()=>{d.current=!0},0),()=>{d.current=!1}),[]);const l=_e(Ve(s),c),m=ke(u=>{const v=g.current;g.current=!1;const x=ye(c.current);if(!d.current||!c.current||"clientX"in u&&Tt(u,x))return;if(h.current){h.current=!1;return}let p;u.composedPath?p=u.composedPath().includes(c.current):p=!x.documentElement.contains(u.target)||c.current.contains(u.target),!p&&(n||!v)&&i(u)}),C=u=>v=>{g.current=!0;const x=s.props[u];x&&x(v)},y={ref:l};return r!==!1&&(y[r]=C(r)),a.useEffect(()=>{if(r!==!1){const u=De(r),v=ye(c.current),x=()=>{h.current=!0};return v.addEventListener(u,m),v.addEventListener("touchmove",x),()=>{v.removeEventListener(u,m),v.removeEventListener("touchmove",x)}}},[m,r]),o!==!1&&(y[o]=C(o)),a.useEffect(()=>{if(o!==!1){const u=De(o),v=ye(c.current);return v.addEventListener(u,m),()=>{v.removeEventListener(u,m)}}},[m,o]),a.cloneElement(s,y)}function Et(t){return re("MuiDialog",t)}const Se=te("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Rt=a.createContext({}),zt=L(qe,{name:"MuiDialog",slot:"Backdrop",overrides:(t,s)=>s.backdrop})({zIndex:-1}),Lt=t=>{const{classes:s,scroll:n,maxWidth:o,fullWidth:i,fullScreen:r}=t,h={root:["root"],container:["container",`scroll${z(n)}`],paper:["paper",`paperScroll${z(n)}`,`paperWidth${z(String(o))}`,i&&"paperFullWidth",r&&"paperFullScreen"]};return le(h,Et,s)},Dt=L(Te,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),It=L("div",{name:"MuiDialog",slot:"Container",overridesResolver:(t,s)=>{const{ownerState:n}=t;return[s.container,s[`scroll${z(n.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Wt=L(ce,{name:"MuiDialog",slot:"Paper",overridesResolver:(t,s)=>{const{ownerState:n}=t;return[s.paper,s[`scrollPaper${z(n.scroll)}`],s[`paperWidth${z(String(n.maxWidth))}`],n.fullWidth&&s.paperFullWidth,n.fullScreen&&s.paperFullScreen]}})(ie(({theme:t})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:s})=>!s.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:t.breakpoints.unit==="px"?Math.max(t.breakpoints.values.xs,444):`max(${t.breakpoints.values.xs}${t.breakpoints.unit}, 444px)`,[`&.${Se.paperScrollBody}`]:{[t.breakpoints.down(Math.max(t.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(t.breakpoints.values).filter(s=>s!=="xs").map(s=>({props:{maxWidth:s},style:{maxWidth:`${t.breakpoints.values[s]}${t.breakpoints.unit}`,[`&.${Se.paperScrollBody}`]:{[t.breakpoints.down(t.breakpoints.values[s]+64)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:s})=>s.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:s})=>s.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${Se.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Nt=a.forwardRef(function(s,n){const o=ae({props:s,name:"MuiDialog"}),i=Pe(),r={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{"aria-describedby":h,"aria-labelledby":c,"aria-modal":d=!0,BackdropComponent:g,BackdropProps:l,children:m,className:C,disableEscapeKeyDown:y=!1,fullScreen:u=!1,fullWidth:v=!1,maxWidth:x="sm",onClick:p,onClose:b,open:w,PaperComponent:S=ce,PaperProps:D={},scroll:W="paper",slots:V={},slotProps:K={},TransitionComponent:Y=Re,transitionDuration:F=r,TransitionProps:G,...X}=o,E={...o,disableEscapeKeyDown:y,fullScreen:u,fullWidth:v,maxWidth:x,scroll:W},B=Lt(E),M=a.useRef(),q=A=>{M.current=A.target===A.currentTarget},O=A=>{p&&p(A),M.current&&(M.current=null,b&&b(A,"backdropClick"))},f=Ye(c),k=a.useMemo(()=>({titleId:f}),[f]),j={transition:Y,...V},U={transition:G,paper:D,backdrop:l,...K},R={slots:j,slotProps:U},[Q,se]=T("root",{elementType:Dt,shouldForwardComponentProp:!0,externalForwardedProps:R,ownerState:E,className:ne(B.root,C),ref:n}),[de,Z]=T("backdrop",{elementType:zt,shouldForwardComponentProp:!0,externalForwardedProps:R,ownerState:E}),[P,oe]=T("paper",{elementType:Wt,shouldForwardComponentProp:!0,externalForwardedProps:R,ownerState:E,className:ne(B.paper,D.className)}),[fe,ge]=T("container",{elementType:It,externalForwardedProps:R,ownerState:E,className:B.container}),[xe,ve]=T("transition",{elementType:Re,externalForwardedProps:R,ownerState:E,additionalProps:{appear:!0,in:w,timeout:F,role:"presentation"}});return e.jsx(Q,{closeAfterTransition:!0,slots:{backdrop:de},slotProps:{backdrop:{transitionDuration:F,as:g,...Z}},disableEscapeKeyDown:y,onClose:b,open:w,onClick:O,...se,...X,children:e.jsx(xe,{...ve,children:e.jsx(fe,{onMouseDown:q,...ge,children:e.jsx(P,{as:S,elevation:24,role:"dialog","aria-describedby":h,"aria-labelledby":f,"aria-modal":d,...oe,children:e.jsx(Rt.Provider,{value:k,children:m})})})})})});function $t(t){return re("MuiDialogContent",t)}te("MuiDialogContent",["root","dividers"]);const Ft=te("MuiDialogTitle",["root"]),Bt=t=>{const{classes:s,dividers:n}=t;return le({root:["root",n&&"dividers"]},$t,s)},Ot=L("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:n}=t;return[s.root,n.dividers&&s.dividers]}})(ie(({theme:t})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:s})=>s.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(t.vars||t).palette.divider}`,borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:s})=>!s.dividers,style:{[`.${Ft.root} + &`]:{paddingTop:0}}}]}))),Ut=a.forwardRef(function(s,n){const o=ae({props:s,name:"MuiDialogContent"}),{className:i,dividers:r=!1,...h}=o,c={...o,dividers:r},d=Bt(c);return e.jsx(Ot,{className:ne(d.root,i),ownerState:c,ref:n,...h})});function Ht(t={}){const{autoHideDuration:s=null,disableWindowBlurListener:n=!1,onClose:o,open:i,resumeHideDuration:r}=t,h=Ge();a.useEffect(()=>{if(!i)return;function p(b){b.defaultPrevented||b.key==="Escape"&&o?.(b,"escapeKeyDown")}return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[i,o]);const c=ke((p,b)=>{o?.(p,b)}),d=ke(p=>{!o||p==null||h.start(p,()=>{c(null,"timeout")})});a.useEffect(()=>(i&&d(s),h.clear),[i,s,d,h]);const g=p=>{o?.(p,"clickaway")},l=h.clear,m=a.useCallback(()=>{s!=null&&d(r??s*.5)},[s,r,d]),C=p=>b=>{const w=p.onBlur;w?.(b),m()},y=p=>b=>{const w=p.onFocus;w?.(b),l()},u=p=>b=>{const w=p.onMouseEnter;w?.(b),l()},v=p=>b=>{const w=p.onMouseLeave;w?.(b),m()};return a.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",m),window.addEventListener("blur",l),()=>{window.removeEventListener("focus",m),window.removeEventListener("blur",l)}},[n,i,m,l]),{getRootProps:(p={})=>{const b={...Ae(t),...Ae(p)};return{role:"presentation",...p,...b,onBlur:C(b),onFocus:y(b),onMouseEnter:u(b),onMouseLeave:v(b)}},onClickAway:g}}function Qt(t){return re("MuiSnackbarContent",t)}te("MuiSnackbarContent",["root","message","action"]);const _t=t=>{const{classes:s}=t;return le({root:["root"],action:["action"],message:["message"]},Qt,s)},Vt=L(ce,{name:"MuiSnackbarContent",slot:"Root"})(ie(({theme:t})=>{const s=t.palette.mode==="light"?.8:.98;return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(Ee(t.palette.background.default,s)),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:Ee(t.palette.background.default,s),display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),Yt=L("div",{name:"MuiSnackbarContent",slot:"Message"})({padding:"8px 0"}),Gt=L("div",{name:"MuiSnackbarContent",slot:"Action"})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Xt=a.forwardRef(function(s,n){const o=ae({props:s,name:"MuiSnackbarContent"}),{action:i,className:r,message:h,role:c="alert",...d}=o,g=o,l=_t(g);return e.jsxs(Vt,{role:c,elevation:6,className:ne(l.root,r),ownerState:g,ref:n,...d,children:[e.jsx(Yt,{className:l.message,ownerState:g,children:h}),i?e.jsx(Gt,{className:l.action,ownerState:g,children:i}):null]})});function Kt(t){return re("MuiSnackbar",t)}te("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const qt=t=>{const{classes:s,anchorOrigin:n}=t,o={root:["root",`anchorOrigin${z(n.vertical)}${z(n.horizontal)}`]};return le(o,Kt,s)},Jt=L("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:n}=t;return[s.root,s[`anchorOrigin${z(n.anchorOrigin.vertical)}${z(n.anchorOrigin.horizontal)}`]]}})(ie(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:s})=>s.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:s})=>s.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:s})=>s.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:s})=>s.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:s})=>s.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),Zt=a.forwardRef(function(s,n){const o=ae({props:s,name:"MuiSnackbar"}),i=Pe(),r={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:h,anchorOrigin:{vertical:c,horizontal:d}={vertical:"bottom",horizontal:"left"},autoHideDuration:g=null,children:l,className:m,ClickAwayListenerProps:C,ContentProps:y,disableWindowBlurListener:u=!1,message:v,onBlur:x,onClose:p,onFocus:b,onMouseEnter:w,onMouseLeave:S,open:D,resumeHideDuration:W,slots:V={},slotProps:K={},TransitionComponent:Y,transitionDuration:F=r,TransitionProps:{onEnter:G,onExited:X,...E}={},...B}=o,M={...o,anchorOrigin:{vertical:c,horizontal:d},autoHideDuration:g,disableWindowBlurListener:u,TransitionComponent:Y,transitionDuration:F},q=qt(M),{getRootProps:O,onClickAway:f}=Ht({...M}),[k,j]=a.useState(!0),U=A=>{j(!0),X&&X(A)},R=(A,N)=>{j(!1),G&&G(A,N)},Q={slots:{transition:Y,...V},slotProps:{content:y,clickAwayListener:C,transition:E,...K}},[se,de]=T("root",{ref:n,className:[q.root,m],elementType:Jt,getSlotProps:O,externalForwardedProps:{...Q,...B},ownerState:M}),[Z,{ownerState:P,...oe}]=T("clickAwayListener",{elementType:At,externalForwardedProps:Q,getSlotProps:A=>({onClickAway:(...N)=>{const Be=N[0];A.onClickAway?.(...N),!Be?.defaultMuiPrevented&&f(...N)}}),ownerState:M}),[fe,ge]=T("content",{elementType:Xt,shouldForwardComponentProp:!0,externalForwardedProps:Q,additionalProps:{message:v,action:h},ownerState:M}),[xe,ve]=T("transition",{elementType:Xe,externalForwardedProps:Q,getSlotProps:A=>({onEnter:(...N)=>{A.onEnter?.(...N),R(...N)},onExited:(...N)=>{A.onExited?.(...N),U(...N)}}),additionalProps:{appear:!0,in:D,timeout:F,direction:c==="top"?"down":"up"},ownerState:M});return!D&&k?null:e.jsx(Z,{...oe,...V.clickAwayListener&&{ownerState:P},children:e.jsx(se,{...de,children:e.jsx(xe,{...ve,children:l||e.jsx(fe,{...ge})})})})}),es=Fe({themeId:Ke}),ts=$(e.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m-2 14-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"})),ss=$(e.jsx("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"})),os=$(e.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"})),ns=$(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),rs=$([e.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4z"},"0"),e.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-5.99 13c-.59 0-1.05-.47-1.05-1.05 0-.59.47-1.04 1.05-1.04.59 0 1.04.45 1.04 1.04-.01.58-.45 1.05-1.04 1.05m2.5-6.17c-.63.93-1.23 1.21-1.56 1.81-.13.24-.18.4-.18 1.18h-1.52c0-.41-.06-1.08.26-1.65.41-.73 1.18-1.16 1.63-1.8.48-.68.21-1.94-1.14-1.94-.88 0-1.32.67-1.5 1.23l-1.37-.57C11.51 5.96 12.52 5 13.99 5c1.23 0 2.08.56 2.51 1.26.37.61.58 1.73.01 2.57"},"1")]),as=$(e.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"})),ls={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:450,bgcolor:"background.paper",borderRadius:2,boxShadow:24,p:4},is=({open:t,onClose:s,sectionId:n})=>{const[o,i]=a.useState(""),[r,h]=a.useState(0),[c,d]=a.useState(30),[g,l]=a.useState("Core"),[m,C]=a.useState("Medium"),[y,u]=a.useState(""),[v,x]=a.useState(!1),[p,b]=a.useState(!1),w=async()=>{if(!o.trim()){u("Quiz title is required"),x(!0);return}if(r<=0){u("Marks must be greater than 0"),x(!0);return}if(c<=0){u("Duration must be greater than 0"),x(!0);return}b(!0),u(""),x(!1);try{const S=await me.post(`${he}/api/campus/create/quiz/${n}`,{title:o,marks:r,duration:c,category:g,difficulty:m,sectionId:n},{withCredentials:!0});S.data.success?(u("Quiz created successfully!"),x(!1),i(""),h(0),d(30),l("Core"),C("Medium")):(u(S.data.message||"Failed to create quiz"),x(!0))}catch(S){console.error(S),u(S?.response?.data?.message||"Internal Server Error"),x(!0)}finally{b(!1)}};return e.jsx(Te,{open:t,onClose:s,children:e.jsx(J,{sx:ls,children:e.jsxs(J,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(I,{label:"Quiz Title",value:o,onChange:S=>i(S.target.value),fullWidth:!0}),e.jsxs(J,{display:"flex",gap:2,children:[e.jsx(I,{label:"Marks",type:"number",value:r,onChange:S=>h(Number(S.target.value)),fullWidth:!0}),e.jsx(I,{label:"Duration (minutes)",type:"number",value:c,onChange:S=>d(Number(S.target.value)),fullWidth:!0})]}),e.jsxs(J,{display:"flex",gap:2,children:[e.jsxs(I,{select:!0,label:"Category",value:g,onChange:S=>l(S.target.value),fullWidth:!0,children:[e.jsx(H,{value:"Core",children:"Core"}),e.jsx(H,{value:"Aptitude",children:"Aptitude"}),e.jsx(H,{value:"Misc",children:"Misc"})]}),e.jsxs(I,{select:!0,label:"Difficulty",value:m,onChange:S=>C(S.target.value),fullWidth:!0,children:[e.jsx(H,{value:"Easy",children:"Easy"}),e.jsx(H,{value:"Medium",children:"Medium"}),e.jsx(H,{value:"Hard",children:"Hard"})]})]}),e.jsx(ee,{sx:{backgroundColor:"#FF5C01",color:"#ffffff"},variant:"contained",color:"primary",onClick:w,disabled:p,children:p?"Creating...":"Create Quiz"}),y&&e.jsx(pe,{textAlign:"center",color:v?"error":"success.main",children:y})]})})})},cs={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:500,bgcolor:"background.paper",borderRadius:2,boxShadow:24,p:4},Ie={name:"",description:"",duration:30,visibility:"private",category:"Placements"},ds=({open:t,onClose:s,sectionId:n})=>{const[o,i]=a.useState(Ie),[r,h]=a.useState(!1),[c,d]=a.useState(""),[g,l]=a.useState(!1),m=y=>{const{name:u,value:v}=y.target;i(x=>({...x,[u]:u==="duration"?Number(v):v}))},C=async()=>{if(!o.name.trim()){d("Test name is required"),l(!0);return}if(o.duration<=0){d("Duration must be greater than 0"),l(!0);return}h(!0),d(""),l(!1);try{const y=await me.post(`${he}/api/campus/create/test/${n}`,o,{withCredentials:!0});y.data?.data?(d("Test created successfully!"),l(!1),i(Ie)):(d(y.data?.error||"Failed to create test"),l(!0))}catch(y){console.error(y),d(y?.response?.data?.error||"Internal Server Error"),l(!0)}finally{h(!1)}};return e.jsx(Te,{open:t,onClose:s,children:e.jsxs(J,{sx:cs,children:[e.jsx(pe,{variant:"h6",fontWeight:"bold",mb:3,children:"Create New Test"}),e.jsxs(J,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(I,{label:"Test Name",name:"name",value:o.name,onChange:m,fullWidth:!0}),e.jsx(I,{label:"Description",name:"description",value:o.description,onChange:m,multiline:!0,rows:3,fullWidth:!0}),e.jsx(I,{label:"Duration (minutes)",name:"duration",type:"number",value:o.duration,onChange:m,fullWidth:!0}),e.jsxs(I,{select:!0,label:"Category",name:"category",value:o.category,onChange:m,fullWidth:!0,children:[e.jsx(H,{value:"Placements",children:"Placements"}),e.jsx(H,{value:"Gate",children:"Gate"})]}),e.jsx(ee,{variant:"contained",color:"primary",onClick:C,disabled:r,sx:{backgroundColor:"#FF5C01",color:"#ffffff"},children:r?e.jsx(we,{size:20}):"Create Test"}),c&&e.jsx(pe,{textAlign:"center",color:g?"error":"success.main",children:c})]})]})})};function us({open:t,setOpen:s}){const[n,o]=a.useState([]),[i,r]=a.useState(null);console.log(i);const[h,c]=a.useState(!1),[d,g]=a.useState(null),[l,m]=a.useState(0),[C,y]=a.useState(5),[u,v]=a.useState(""),[x,p]=a.useState(!1),[b,w]=a.useState({open:!1,message:"",severity:"success"}),D=Me(f=>f.auth.user)?.user._id,{id:W}=We(),V=Me(Ne),K=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,Y=Pe(),F=es(Y.breakpoints.down("sm")),G=async f=>{if(f.preventDefault(),n.length===0){g("Please add at least one valid email");return}if(n.filter(j=>j.role==="campus-admin").length>5){g("You can only invite up to 5 campus-admins at a time.");return}p(!0),w({open:!0,message:"Processing invites...",severity:"info"});try{const j=n.map(R=>({email:R.email,name:R.name||"Unknown",role:R.role,groupId:V,sectionId:W,invitedBy:D})),U=await me.post(`${he}/api/campus/section/add`,{invites:j},{withCredentials:!0});r(U.data),o([]),g(null),w({open:!0,message:"Invites sent successfully!",severity:"success"})}catch(j){r({error:j.response?.data||j.message}),w({open:!0,message:j.response?.data?.message||"Failed to send invites.",severity:"error"})}finally{p(!1)}},X=()=>{o(f=>[...f,{email:"",name:"",role:"user"}])},E=f=>{const k=f.target.files?.[0];if(!k)return;c(!0);const j=new FileReader;j.onload=U=>{const R=new Uint8Array(U.target?.result),Q=tt(R,{type:"array"}),se=Q.Sheets[Q.SheetNames[0]],Z=ue.sheet_to_json(se).map(P=>({email:P.Email?.trim(),name:P.Name?.trim()||"Unknown",role:P.Role&&["user","campus-admin"].includes(P.Role)?P.Role:"user"})).filter(P=>P.email&&K.test(P.email)&&!n.some(oe=>oe.email===P.email));Z.length===0?g("No valid users found in file"):(o(P=>[...P,...Z]),g(null)),c(!1)},j.readAsArrayBuffer(k)},B=()=>{const f=[{Name:"John Doe",Email:"user1@example.com",Role:"user"},{Name:"Jane Smith",Email:"user2@example.com",Role:"campus-admin"}],k=ue.json_to_sheet(f),j=ue.book_new();ue.book_append_sheet(j,k,"Users"),st(j,"sample_users.xlsx")},M=(f,k,j)=>{const U=[...n];U[f][k]=j,o(U)},q=f=>{const k=[...n];k.splice(f,1),o(k)},O=a.useMemo(()=>u?n.filter(f=>f.email.toLowerCase().includes(u.toLowerCase())||f.name.toLowerCase().includes(u.toLowerCase())):n,[u,n]);return e.jsxs(e.Fragment,{children:[e.jsx(Nt,{maxWidth:"xl",fullWidth:!0,open:t,onClose:()=>s(!1),fullScreen:F,PaperProps:{sx:{p:3,height:F?"100%":"90vh"}},children:e.jsxs(Ut,{className:"flex flex-col gap-3",sx:{overflowY:"auto"},children:[e.jsx(pe,{variant:"h5",mb:2,align:"center",children:"Add Members"}),e.jsx(je,{onClick:()=>s(!1),sx:{position:"absolute",right:5,top:3},children:e.jsx(ot,{})}),e.jsx(I,{size:"small",fullWidth:!0,placeholder:"Search by name or email",value:u,onChange:f=>v(f.target.value),sx:{mb:2}}),e.jsxs("form",{onSubmit:G,className:"flex flex-col gap-3",children:[d&&e.jsx(Je,{error:!0,children:d}),e.jsxs(J,{display:"flex",gap:1,children:[e.jsxs(ee,{variant:"outlined",size:"small",startIcon:e.jsx(nt,{}),component:"label",disabled:h,children:[h?e.jsx(we,{size:18}):"Upload",e.jsx("input",{type:"file",hidden:!0,accept:".xlsx,.xls,.csv",onChange:E})]}),e.jsx(ee,{variant:"outlined",size:"small",startIcon:e.jsx(os,{}),onClick:B,children:"Sample"}),e.jsx(ee,{variant:"outlined",size:"small",onClick:X,children:"Add Row"})]}),e.jsxs(rt,{component:ce,sx:{mt:2},children:[e.jsxs(at,{size:"small",children:[e.jsx(lt,{children:e.jsxs(Ce,{children:[e.jsx(_,{children:"Email"}),e.jsx(_,{children:"Name"}),e.jsx(_,{children:"Role"}),e.jsx(_,{children:"Action"})]})}),e.jsx(it,{children:O.length>0?O.slice(l*C,l*C+C).map((f,k)=>e.jsxs(Ce,{children:[e.jsx(_,{children:e.jsx(I,{fullWidth:!0,size:"small",value:f.email,onChange:j=>M(l*C+k,"email",j.target.value)})}),e.jsx(_,{children:e.jsx(I,{size:"small",fullWidth:!0,value:f.name,onChange:j=>M(l*C+k,"name",j.target.value)})}),e.jsx(_,{children:e.jsxs(Ze,{fullWidth:!0,size:"small",value:f.role,onChange:j=>M(l*C+k,"role",j.target.value),children:[e.jsx(H,{value:"user",children:"User"}),e.jsx(H,{value:"campus-admin",children:"Campus Admin"})]})}),e.jsx(_,{children:e.jsx(je,{color:"error",onClick:()=>q(l*C+k),children:e.jsx(ct,{})})})]},k)):e.jsx(Ce,{children:e.jsx(_,{colSpan:4,align:"center",children:"No users added yet"})})})]}),O.length>0&&e.jsx(dt,{component:"div",count:O.length,page:l,onPageChange:(f,k)=>m(k),rowsPerPage:C,onRowsPerPageChange:f=>{y(parseInt(f.target.value,10)),m(0)}})]}),e.jsx(ee,{type:"submit",variant:"contained",fullWidth:!0,disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(we,{size:18,sx:{mr:1}}),"Processing..."]}):"Send Invites"})]})]})}),e.jsx(Zt,{open:b.open,autoHideDuration:3e3,onClose:()=>w(f=>({...f,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(Pt,{onClose:()=>w(f=>({...f,open:!1})),severity:b.severity,variant:"filled",sx:{width:"100%"},children:b.message})})]})}const ps=async({sectionId:t,groupId:s})=>s?(await me.get(`${he}/api/campus/insights/${t}/${s}`,{withCredentials:!0})).data:null,Ts=()=>{const[t,s]=a.useState(!1),[n,o]=a.useState(!1),{id:i}=We(),r=Me(Ne)??"",[h,c]=a.useState(!1),[d,g]=a.useState("user"),{data:l,isLoading:m,isError:C,refetch:y}=et({queryKey:["sectionInsights",i,r],queryFn:()=>ps({sectionId:i,groupId:r}),enabled:!!i&&!!r,staleTime:1e3*60*5}),u=[{label:"Total Users",value:l?.totalUsers??0,icon:e.jsx(ns,{className:"text-orange-600"})},{label:"Total Quizzes",value:l?.totalQuizzes??0,icon:e.jsx(rs,{className:"text-orange-600"})},{label:"Quiz Submissions",value:l?.totalQuizSubmissions??0,icon:e.jsx(ts,{className:"text-orange-600"})},{label:"Total Tests",value:l?.totalTests??0,icon:e.jsx(as,{className:"text-orange-600"})},{label:"Test Submissions",value:l?.totalTestSubmissions??0,icon:e.jsx(ss,{className:"text-orange-600"})}],v=({onClick:x,label:p})=>e.jsxs("button",{onClick:x,className:"flex cursor-pointer items-center gap-2 px-5 py-2.5 rounded-full bg-gradient-to-r from-orange-500 to-red-600 text-white text-sm font-medium shadow-md hover:shadow-lg hover:scale-105 active:scale-95 transition-all duration-200",children:[e.jsx("span",{children:p}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})]});return e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsx(us,{role:d,open:h,setOpen:()=>c(!1)}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx(v,{label:"Add Quiz",onClick:()=>s(!0)}),e.jsx(v,{label:"Add Test",onClick:()=>o(!0)}),e.jsxs("div",{className:"relative group",children:[e.jsx(v,{label:"Add Members",onClick:()=>c(!0)}),e.jsxs("div",{className:"absolute hidden group-hover:flex flex-col bg-white border border-gray-200 rounded-lg shadow-lg top-full mt-2 right-0 z-10",children:[e.jsx("button",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 text-left",onClick:()=>{g("user"),c(!0)},children:"Add Students"}),e.jsx("button",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 text-left",onClick:()=>{g("campus-admin"),c(!0)},children:"Add Admins"})]})]})]}),m&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:Array.from({length:5}).map((x,p)=>e.jsx("div",{className:"h-24 bg-gray-200 animate-pulse rounded-2xl"},p))}),C&&e.jsxs("div",{className:"text-red-600 bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"font-medium",children:"Failed to fetch insights."}),e.jsx("button",{onClick:()=>y(),className:"underline text-sm hover:text-red-800",children:"Retry"})]}),!m&&!C&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6",children:u.map((x,p)=>e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-md hover:shadow-lg transition-all duration-200 p-5 flex flex-col items-center text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-orange-100 rounded-full mb-3",children:x.icon}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:x.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:x.value})]},p))}),e.jsx(is,{open:t,onClose:()=>s(!1),sectionId:i}),e.jsx(ds,{open:n,onClose:()=>o(!1),sectionId:i}),e.jsx(ut,{})]})};export{Ts as default};
