import{a as R,g as Q,r as l,u as D,j as e,s as T,c as S,e as b,p as O,Y as q,Z as H,x as m,I as C,_ as v,t as M,B as k}from"./index-C3gQS_fc.js";import{u as K}from"./useQuery-Ctkci8ve.js";import{P as V}from"./Modal-CzDa24g1.js";import{T as W}from"./TextField-55jFifHq.js";import{I as Y,S as Z,T as G,a as J,b as X,c as j,d as n,e as ee}from"./Search-aV1vgIqg.js";import{V as se,E as te}from"./Visibility-Ca8JY6iX.js";import{D as oe}from"./Delete-ZDpJ_jVm.js";import{T as ne}from"./TablePagination-0V_EEHs8.js";import{b as ae,g as ie,D as re,a as le,S as ce,A as de}from"./Snackbar-CESQHQkd.js";import{T as I}from"./Typography-DokONTuu.js";import{B as A}from"./Button-DB3elE-F.js";import"./MenuItem-B5YpP5h8.js";import"./dividerClasses-DjFv4zgk.js";function ue(s){return R("MuiDialogActions",s)}Q("MuiDialogActions",["root","spacing"]);const pe=s=>{const{classes:o,disableSpacing:i}=s;return b({root:["root",!i&&"spacing"]},ue,o)},he=T("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:i}=s;return[o.root,!i.disableSpacing&&o.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:s})=>!s.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),xe=l.forwardRef(function(o,i){const a=D({props:o,name:"MuiDialogActions"}),{className:u,disableSpacing:c=!1,...d}=a,r={...a,disableSpacing:c},p=pe(r);return e.jsx(he,{className:S(p.root,u),ownerState:r,ref:i,...d})});function ge(s){return R("MuiDialogContentText",s)}Q("MuiDialogContentText",["root"]);const me=s=>{const{classes:o}=s,a=b({root:["root"]},ge,o);return{...o,...a}},je=T(I,{shouldForwardProp:s=>O(s)||s==="classes",name:"MuiDialogContentText",slot:"Root"})({}),fe=l.forwardRef(function(o,i){const a=D({props:o,name:"MuiDialogContentText"}),{children:u,className:c,...d}=a,r=me(d);return e.jsx(je,{component:"p",variant:"body1",color:"textSecondary",ref:i,ownerState:d,className:S(r.root,c),...a,classes:r})}),ye=s=>{const{classes:o}=s;return b({root:["root"]},ie,o)},Ce=T(I,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),De=l.forwardRef(function(o,i){const a=D({props:o,name:"MuiDialogTitle"}),{className:u,id:c,...d}=a,r=a,p=ye(r),{titleId:f=c}=l.useContext(ae);return e.jsx(Ce,{component:"h2",className:S(p.root,u),ownerState:r,ref:i,variant:"h6",id:c??f,...d})}),Te=async({sectionId:s,page:o,limit:i,search:a})=>(await M.get(`${k}/api/campus/quiz/get/section/${s}`,{params:{page:o,limit:i,search:a},withCredentials:!0})).data,$e=()=>{const{id:s}=q(),[o,i]=l.useState(0),[a,u]=l.useState(10),[c,d]=l.useState(""),[r,p]=l.useState(c),[f,x]=l.useState(!1),[y,w]=l.useState(null),[h,g]=l.useState({open:!1,message:"",severity:"success"}),U=H();l.useEffect(()=>{const t=setTimeout(()=>{p(c),i(0)},400);return()=>clearTimeout(t)},[c]);const{data:P,isLoading:$}=K({queryKey:["quizzes",s,o,a,r],queryFn:()=>Te({sectionId:s,page:o+1,limit:a,search:r}),enabled:!!s,staleTime:1e3*60*5}),z=P?.quizzes??[],E=P?.totalQuizzes??0,B=(t,L)=>i(L),N=t=>{u(parseInt(t.target.value,10)),i(0)},_=t=>{w(t),x(!0)},F=async()=>{if(y)try{await M.delete(`${k}/api/campus/sections/quiz/delete/${y._id}`,{withCredentials:!0}),g({open:!0,message:"Quiz deleted successfully",severity:"success"}),U.invalidateQueries({queryKey:["quizzes",s,o,a,r]})}catch{g({open:!0,message:"Failed to delete quiz",severity:"error"})}finally{x(!1),w(null)}};return e.jsxs(V,{sx:{p:3,borderRadius:3,overflow:"hidden"},children:[e.jsx(W,{size:"small",placeholder:"Search quizzes...",value:c,onChange:t=>d(t.target.value),sx:{mb:2,width:"100%",maxWidth:400},InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(Z,{})})}}),e.jsx(G,{children:e.jsxs(J,{children:[e.jsx(X,{children:e.jsxs(j,{children:[e.jsx(n,{children:"Title"}),e.jsx(n,{children:"Category"}),e.jsx(n,{children:"Difficulty"}),e.jsx(n,{children:"Duration"}),e.jsx(n,{children:"Marks"}),e.jsx(n,{children:"Created By"}),e.jsx(n,{children:"Cost"}),e.jsx(n,{align:"center",children:"Actions"}),e.jsx(n,{align:"center",children:"Delete"})]})}),e.jsx(ee,{children:$?e.jsx(j,{children:e.jsx(n,{colSpan:9,align:"center",children:"Loading..."})}):z.length===0?e.jsx(j,{children:e.jsx(n,{colSpan:9,align:"center",children:"No quizzes found."})}):z.map(t=>e.jsxs(j,{hover:!0,children:[e.jsx(n,{children:t.title}),e.jsx(n,{children:t.category}),e.jsx(n,{children:t.difficulty}),e.jsxs(n,{children:[t.duration," min"]}),e.jsx(n,{children:t.marks}),e.jsx(n,{children:t.creator?.name||"-"}),e.jsx(n,{children:e.jsx(m,{title:`Total: ${t.costPerAttempt*t.noOfSubmissions}`,arrow:!0,children:e.jsx("span",{children:(t.costPerAttempt||0)*(t.noOfSubmissions||0)})})}),e.jsxs(n,{align:"center",children:[e.jsx(m,{title:"Preview Quiz",children:e.jsx(C,{component:v,to:`preview/${t.slug}`,color:"primary",size:"small",children:e.jsx(se,{fontSize:"small"})})}),e.jsx(m,{title:"Edit Quiz",children:e.jsx(C,{component:v,to:`edit/${t._id}`,color:"warning",size:"small",children:e.jsx(te,{fontSize:"small"})})})]}),e.jsx(n,{align:"center",children:e.jsx(m,{title:"Delete Quiz",children:e.jsx(C,{color:"error",size:"small",onClick:()=>_(t),children:e.jsx(oe,{fontSize:"small"})})})})]},t._id))})]})}),e.jsx(ne,{component:"div",count:E,page:o,onPageChange:B,rowsPerPage:a,onRowsPerPageChange:N,rowsPerPageOptions:[5,10,20,50]}),e.jsxs(re,{open:f,onClose:()=>x(!1),children:[e.jsx(De,{children:"Confirm Deletion"}),e.jsx(le,{children:e.jsxs(fe,{children:['Are you sure you want to delete quiz "',y?.title,'"? This action cannot be undone.']})}),e.jsxs(xe,{children:[e.jsx(A,{onClick:()=>x(!1),color:"inherit",children:"Cancel"}),e.jsx(A,{onClick:F,color:"error",variant:"contained",children:"Delete"})]})]}),e.jsx(ce,{open:h.open,autoHideDuration:3e3,onClose:()=>g({...h,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(de,{onClose:()=>g({...h,open:!1}),severity:h.severity,sx:{width:"100%"},children:h.message})})]})};export{$e as default};
