import{r as n,ak as E,A as q,Q as z,y as L,j as e,H as M,I as W,J as U,a8 as _,aC as H,at as K,aj as u,z as b,an as O,P as Q,ao as G,ap as J,aq as g,ar as a,as as V,S as X,K as Y,aa as Z,E as ee,F as se,G as ae,W as te,L as ne,N as T,x as N,B as w}from"./index-gwSlh4W6.js";const le=async(l,x,i,m,t,r)=>(await N.get(`${w}/api/campus/students/${l}?page=${x}&limit=${i}&search=${m}&role=${t}&status=${r}`,{withCredentials:!0})).data,oe=()=>{const[l,x]=n.useState(""),[i,m]=n.useState(l),[t,r]=n.useState(1),[o,$]=n.useState("all"),[A,c]=n.useState(!1),[y,S]=n.useState(null),[k,D]=n.useState("invite"),d=10,{id:h}=E(),{enqueueSnackbar:f}=q(),I=z(s=>s.auth.user);n.useEffect(()=>{const s=setTimeout(()=>{m(l),r(1)},400);return()=>clearTimeout(s)},[l]);const{data:v,isLoading:P,refetch:R}=L({queryKey:["students",h,t,i,o],queryFn:()=>le(h,t,d,i,"all",o)}),F=(s,p)=>{S(s),D(p==="member"||p==="admin"?p:"invite"),c(!0)},B=async()=>{if(y)try{await N.delete(`${w}/api/campus/students/${h}/${y}?status=${k}`,{withCredentials:!0}),f("Student removed successfully!",{variant:"success"}),R()}catch(s){console.error("Failed to remove student",s),f("Failed to remove student!",{variant:"error"})}finally{c(!1),S(null)}},C=v?.data||[],j=v?.total||0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(M,{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",children:[e.jsx(W,{value:l,onChange:s=>x(s.target.value),size:"small",label:"Search by name or email",InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx(_,{})})},sx:{maxWidth:280}}),I?.user.role=="campus-superadmin"&&e.jsx(H,{size:"small",sx:{minWidth:160},children:e.jsxs(K,{value:o,onChange:s=>$(s.target.value),children:[e.jsx(u,{value:"all",children:"All"}),e.jsx(u,{value:"member",children:"Member"}),e.jsx(u,{value:"pending",children:"Pending"}),e.jsx(u,{value:"admin",children:"Admin"})]})})]}),P?e.jsx(b,{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx(O,{component:Q,className:"shadow mt-6 rounded-lg",children:e.jsxs(G,{children:[e.jsx(J,{className:"bg-orange-50",children:e.jsxs(g,{children:[e.jsx(a,{children:"Name"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"Role"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsxs(V,{children:[C.length===0&&e.jsx(g,{children:e.jsx(a,{colSpan:7,align:"center",children:e.jsx(b,{color:"textSecondary",children:"No students found"})})}),C.map(s=>e.jsxs(g,{hover:!0,children:[e.jsx(a,{children:s.name}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.role}),e.jsx(a,{children:s.status==="member"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:"Member"}):s.status==="admin"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded",children:"Admin"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 rounded",children:"Pending"})}),e.jsx(a,{children:e.jsx(X,{title:"Remove Student",children:e.jsx(Y,{size:"small",color:"error",onClick:()=>F(s._id,s.status),children:e.jsx(Z,{})})})})]},s._id))]})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsxs(b,{variant:"body2",color:"textSecondary",children:["Showing ",(t-1)*d+1," - ",Math.min(t*d,j)," of ",j]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:t===1,onClick:()=>r(s=>s-1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:t*d>=j,onClick:()=>r(s=>s+1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})]}),e.jsxs(ee,{open:A,onClose:()=>c(!1),children:[e.jsx(se,{children:"Confirm Removal"}),e.jsx(ae,{children:e.jsx(te,{children:"Are you sure you want to remove this student? This action cannot be undone."})}),e.jsxs(ne,{children:[e.jsx(T,{onClick:()=>c(!1),children:"Cancel"}),e.jsx(T,{color:"error",onClick:B,children:"Remove"})]})]})]})};export{oe as S};
