import{ag as I,r as a,at as O,y as _,j as e,P as L,a5 as q,a6 as F,a7 as K,aj as H,ak as N,al as G,am as u,an as t,ao as J,G as x,I as m,au as z,av as M,aw as U,a8 as V,aq as W,J as X,K as Y,N as Z,O as ee,Q as se,R as S,ax as te,ay as ae,x as P,B as b}from"./index-DrrpgQNc.js";const ne=async({sectionId:n,page:i,limit:l,search:r})=>(await P.get(`${b}/api/campus/quiz/get/section/${n}`,{params:{page:i,limit:l,search:r},withCredentials:!0})).data,re=()=>{const{id:n}=I(),[i,l]=a.useState(0),[r,p]=a.useState(10),[c,D]=a.useState(""),[j,w]=a.useState(c),[T,d]=a.useState(!1),[g,y]=a.useState(null),[o,h]=a.useState({open:!1,message:"",severity:"success"}),v=O();a.useEffect(()=>{const s=setTimeout(()=>{w(c),l(0)},400);return()=>clearTimeout(s)},[c]);const{data:f,isLoading:Q}=_({queryKey:["quizzes",n,i,r,j],queryFn:()=>ne({sectionId:n,page:i+1,limit:r,search:j}),enabled:!!n,staleTime:1e3*60*5}),C=f?.quizzes??[],k=f?.totalQuizzes??0,A=(s,B)=>l(B),R=s=>{p(parseInt(s.target.value,10)),l(0)},E=s=>{y(s),d(!0)},$=async()=>{if(g)try{await P.delete(`${b}/api/campus/sections/quiz/delete/${g._id}`,{withCredentials:!0}),h({open:!0,message:"Quiz deleted successfully",severity:"success"}),v.invalidateQueries({queryKey:["quizzes",n,i,r,j]})}catch{h({open:!0,message:"Failed to delete quiz",severity:"error"})}finally{d(!1),y(null)}};return e.jsxs(L,{sx:{p:3,borderRadius:3,overflow:"hidden"},children:[e.jsx(q,{size:"small",placeholder:"Search quizzes...",value:c,onChange:s=>D(s.target.value),sx:{mb:2,width:"100%",maxWidth:400},InputProps:{startAdornment:e.jsx(F,{position:"start",children:e.jsx(K,{})})}}),e.jsx(H,{children:e.jsxs(N,{children:[e.jsx(G,{children:e.jsxs(u,{children:[e.jsx(t,{children:"Title"}),e.jsx(t,{children:"Category"}),e.jsx(t,{children:"Difficulty"}),e.jsx(t,{children:"Duration"}),e.jsx(t,{children:"Marks"}),e.jsx(t,{children:"Created By"}),e.jsx(t,{children:"Cost"}),e.jsx(t,{align:"center",children:"Actions"}),e.jsx(t,{align:"center",children:"Delete"})]})}),e.jsx(J,{children:Q?e.jsx(u,{children:e.jsx(t,{colSpan:9,align:"center",children:"Loading..."})}):C.length===0?e.jsx(u,{children:e.jsx(t,{colSpan:9,align:"center",children:"No quizzes found."})}):C.map(s=>e.jsxs(u,{hover:!0,children:[e.jsx(t,{children:s.title}),e.jsx(t,{children:s.category}),e.jsx(t,{children:s.difficulty}),e.jsxs(t,{children:[s.duration," min"]}),e.jsx(t,{children:s.marks}),e.jsx(t,{children:s.creator?.name||"-"}),e.jsx(t,{children:e.jsx(x,{title:`Total: ${s.costPerAttempt*s.noOfSubmissions}`,arrow:!0,children:e.jsx("span",{children:(s.costPerAttempt||0)*(s.noOfSubmissions||0)})})}),e.jsxs(t,{align:"center",children:[e.jsx(x,{title:"Preview Quiz",children:e.jsx(m,{component:z,to:`preview/${s.slug}`,color:"primary",size:"small",children:e.jsx(M,{fontSize:"small"})})}),e.jsx(x,{title:"Edit Quiz",children:e.jsx(m,{component:z,to:`edit/${s._id}`,color:"warning",size:"small",children:e.jsx(U,{fontSize:"small"})})})]}),e.jsx(t,{align:"center",children:e.jsx(x,{title:"Delete Quiz",children:e.jsx(m,{color:"error",size:"small",onClick:()=>E(s),children:e.jsx(V,{fontSize:"small"})})})})]},s._id))})]})}),e.jsx(W,{component:"div",count:k,page:i,onPageChange:A,rowsPerPage:r,onRowsPerPageChange:R,rowsPerPageOptions:[5,10,20,50]}),e.jsxs(X,{open:T,onClose:()=>d(!1),children:[e.jsx(Y,{children:"Confirm Deletion"}),e.jsx(Z,{children:e.jsxs(ee,{children:['Are you sure you want to delete quiz "',g?.title,'"? This action cannot be undone.']})}),e.jsxs(se,{children:[e.jsx(S,{onClick:()=>d(!1),color:"inherit",children:"Cancel"}),e.jsx(S,{onClick:$,color:"error",variant:"contained",children:"Delete"})]})]}),e.jsx(te,{open:o.open,autoHideDuration:3e3,onClose:()=>h({...o,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(ae,{onClose:()=>h({...o,open:!1}),severity:o.severity,sx:{width:"100%"},children:o.message})})]})};export{re as default};
