import{r as d,j as e,I as b,T as w,z as y,B as S}from"./index-CDh8duXN.js";import{u as $}from"./useQuery-_GH0mkah.js";import{a as C,P,T as g}from"./TextField-R6QlZSm6.js";import{I as R,S as E,T as F,a as z,b as A,c as h,d as t,e as B}from"./Search-bndXh_Bb.js";import{D as k}from"./Delete-BxiGJLKm.js";const D=async(n,r,i,l,c)=>(await y.get(`${S}/api/campus/students/${n}/${r}?page=${i}&limit=${l}&search=${c}`,{withCredentials:!0})).data,H=({sectionId:n})=>{const[r,i]=d.useState(""),[l,c]=d.useState(r),[a,x]=d.useState(1),o=10,u="";d.useEffect(()=>{const s=setTimeout(()=>{c(r),x(1)},400);return()=>clearTimeout(s)},[r]);const{data:p,isLoading:f,refetch:T}=$({queryKey:["students",n,u,a,l],queryFn:()=>D(n,u,a,o,l),enabled:!!n&&!1}),N=async s=>{try{await y.delete(`${S}/api/campus/students/${n}/${s}`,{withCredentials:!0}),T()}catch(v){console.error("Failed to remove student",v)}},j=p?.data||[],m=p?.total||0;return e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{value:r,onChange:s=>i(s.target.value),size:"small",label:"Search by name or email",InputProps:{startAdornment:e.jsx(R,{position:"start",children:e.jsx(b,{size:"small",edge:"start",children:e.jsx(E,{})})})},sx:{maxWidth:320}}),f?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsx(F,{component:P,className:"shadow mt-10 rounded-lg",children:e.jsxs(z,{children:[e.jsx(A,{className:"bg-orange-50",children:e.jsxs(h,{children:[e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Role"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsxs(B,{children:[j.length===0&&e.jsx(h,{children:e.jsx(t,{colSpan:7,align:"center",children:e.jsx(g,{color:"textSecondary",children:"No students found"})})}),j.map(s=>e.jsxs(h,{hover:!0,className:"transition duration-150 ease-in-out",children:[e.jsx(t,{children:s.name}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.role}),e.jsx(t,{children:s.status==="member"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-green-700 bg-green-100 rounded",children:"Member"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-100 rounded",children:"Pending"})}),e.jsx(t,{children:e.jsx(w,{title:"Remove Student",children:e.jsx(b,{size:"small",color:"error",onClick:()=>N(s._id),children:e.jsx(k,{})})})})]},s._id))]})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs(g,{variant:"body2",color:"textSecondary",children:["Showing ",(a-1)*o+1," - ",Math.min(a*o,m)," ","of ",m]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:a===1,onClick:()=>x(s=>s-1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{disabled:a*o>=m,onClick:()=>x(s=>s+1),className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})]})]})};export{H as S};
